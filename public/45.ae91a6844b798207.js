"use strict";(self.webpackChunksistema=self.webpackChunksistema||[]).push([[45],{1045:(j,p,a)=>{a.r(p),a.d(p,{PerfilModule:()=>E});var c=a(6895),n=a(433),d=a(4154),g=a(805),b=a(5226),f=a.n(b),e=a(8256),Z=a(5948),I=a(248),_=a(3608),h=a(5593),F=a(369),x=a(1740),T=a(1167),U=a(8741),C=a(1481);const P=["fileInput"];let N=(()=>{class i{constructor(o){this.sanitizer=o,this.imageUrl="",this.imageSelected=new e.vpe}onSelectFile(o){const t=o.target.files[0];if(t){if(t.size>5242880)return void f().fire("La imagen no debe pesar m\xe1s de 5MB.","","warning");const s=new FileReader;s.onload=u=>{this.imageUrl=u.target.result,this.imageSelected.emit(u.target.result.split(",")[1])},s.readAsDataURL(t)}}triggerFileInput(){this.fileInput.nativeElement.click()}transform(o){return this.sanitizer.bypassSecurityTrustResourceUrl(o||"assets/images/img-user.png")}static#e=this.\u0275fac=function(t){return new(t||i)(e.Y36(C.H7))};static#i=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-upload-profile-img"]],viewQuery:function(t,r){if(1&t&&e.Gf(P,5),2&t){let l;e.iGM(l=e.CRH())&&(r.fileInput=l.first)}},inputs:{imageUrl:"imageUrl"},outputs:{imageSelected:"imageSelected"},decls:5,vars:1,consts:[[1,"image-container"],["pButton","","type","button","icon","pi pi-camera",1,"upload-button",3,"click"],["alt","Profile Image",1,"profile-img",3,"src"],["id","fileInput","type","file",1,"select-profile-picture",3,"change"],["fileInput",""]],template:function(t,r){1&t&&(e.TgZ(0,"div",0)(1,"button",1),e.NdJ("click",function(){return r.triggerFileInput()}),e.qZA(),e._UZ(2,"img",2),e.TgZ(3,"input",3,4),e.NdJ("change",function(s){return r.onSelectFile(s)}),e.qZA()()),2&t&&(e.xp6(2),e.Q6J("src",r.transform(r.imageUrl),e.LSH))},dependencies:[h.Hq],styles:[".image-container[_ngcontent-%COMP%]{position:relative;display:inline-block;text-align:center;width:100px;height:100px}img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;position:absolute;top:40%;left:40%;transform:translate(-50%,-50%);border-radius:50%}.profile-img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;border-radius:50%}.select-profile-picture[_ngcontent-%COMP%]{display:none}.upload-button[_ngcontent-%COMP%]{position:absolute;bottom:5px;right:5px;width:30px;height:30px;border-radius:50%;z-index:1000}"]})}return i})();function S(i,m){1&i&&(e.TgZ(0,"div"),e._uU(1," Nombre de usuario requerido. "),e.qZA())}function A(i,m){1&i&&(e.TgZ(0,"div"),e._uU(1," El nombre de usuario debe tener al menos 4 caracteres. "),e.qZA())}function y(i,m){if(1&i&&(e.TgZ(0,"div",24),e.YNc(1,S,2,0,"div",25),e.YNc(2,A,2,0,"div",25),e.qZA()),2&i){const o=e.oxw();let t,r;e.xp6(1),e.Q6J("ngIf",null==(t=o.miFormulario.get("usuario"))?null:t.hasError("required")),e.xp6(1),e.Q6J("ngIf",null==(r=o.miFormulario.get("usuario"))?null:r.hasError("minlength"))}}function J(i,m){1&i&&(e.TgZ(0,"div"),e._uU(1," El email no es v\xe1lido. "),e.qZA())}function M(i,m){if(1&i&&(e.TgZ(0,"div",24),e.YNc(1,J,2,0,"div",25),e.qZA()),2&i){const o=e.oxw();let t;e.xp6(1),e.Q6J("ngIf",null==(t=o.miFormulario.get("email"))?null:t.hasError("email"))}}function w(i,m){1&i&&(e.TgZ(0,"div"),e._uU(1," Nombre requerido. "),e.qZA())}function Y(i,m){1&i&&(e.TgZ(0,"div"),e._uU(1," El nombre debe tener al menos 4 caracteres. "),e.qZA())}function z(i,m){if(1&i&&(e.TgZ(0,"div",24),e.YNc(1,w,2,0,"div",25),e.YNc(2,Y,2,0,"div",25),e.qZA()),2&i){const o=e.oxw();let t,r;e.xp6(1),e.Q6J("ngIf",null==(t=o.miFormulario.get("nombre"))?null:t.hasError("required")),e.xp6(1),e.Q6J("ngIf",null==(r=o.miFormulario.get("nombre"))?null:r.hasError("minlength"))}}const v=function(){return{margin:".5em",width:"9rem"}},B=[{path:"",children:[{path:":idUsuario",component:(()=>{class i{constructor(o,t,r,l,s){this.fb=o,this.confirmationService=t,this.usuarioService=r,this.sucursalService=l,this.route=s,this.miFormulario=this.fb.group({id:new n.NI({value:"",disabled:!1}),img:new n.NI({value:"",disabled:!1}),usuario:new n.NI({value:"",disabled:!1},[n.kI.required,n.kI.minLength(4)]),nombre:new n.NI({value:"",disabled:!1},[n.kI.required,n.kI.minLength(4)]),apellido:new n.NI({value:"",disabled:!1}),email:new n.NI({value:"",disabled:!1},n.kI.email),estado:new n.NI({value:!0,disabled:!1}),cambiarPassword:new n.NI({value:!0,disabled:!1}),idPerfil:new n.NI({value:null,disabled:!1}),idSucursal:new n.NI({value:null,disabled:!1})}),this.perfiles=[{id:1,nombre:"Administrador"},{id:2,nombre:"Empleado"}],this.imageUrl="",this.isInitialLoad=!0,this.sucursalService.traerSucursales().subscribe(u=>{this.sucursales=u.filter(L=>L.estado)})}ngOnInit(){const o=this.route.snapshot.paramMap.get("idUsuario");o&&(this.miFormulario.get("usuario")?.disable(),this.usuarioService.traerUnUsuario(Number(o)).subscribe(t=>{this.miFormulario.patchValue(t),t.img&&(this.imageUrl=`data:image/jpeg;base64,${t.img}`,this.isInitialLoad=!1)}))}onImageSelected(o){this.imageUrl=`data:image/jpeg;base64,${o}`,this.miFormulario.get("img")?.setValue(o)}confirm(o,t){this.confirmationService.confirm({target:o.originalEvent.target,message:"\xbfCancelar cambio?",icon:"pi pi-exclamation-triangle",defaultFocus:"none",accept:()=>{this.miFormulario.get(t)?.setValue(!o.checked)}})}guardar(){this.miFormulario.get("usuario")?.enable(),this.usuarioService.modificarUsuario(this.miFormulario.value).subscribe(o=>{f().fire(o.msg,"",o.icon),o.ok||this.miFormulario.get("usuario")?.disable()})}static#e=this.\u0275fac=function(t){return new(t||i)(e.Y36(n.qu),e.Y36(g.YP),e.Y36(Z.i),e.Y36(I.f),e.Y36(d.gz))};static#i=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-formulario-perfil"]],features:[e._Bn([g.YP])],decls:44,vars:12,consts:[[1,"flex","justify-content-center","card"],[1,"card-content"],[1,"flex","col","justify-content-center"],[3,"imageUrl","imageSelected"],["autocomplete","off",1,"pt-2",3,"formGroup","ngSubmit"],[1,"grid"],[1,"col-12","lg:col-6","p-3","m-0"],["htmlFor","usuario"],["pTooltip","Requerido","tooltipPosition","top",1,"required"],["pInputText","","id","usuario","formControlName","usuario","placeholder","Ingrese usuario"],[1,"h-1rem"],["class","error-message",4,"ngIf"],["htmlFor","email"],["pInputText","","id","email","formControlName","email","placeholder","Ingrese email"],["htmlFor","nombre"],["pInputText","","id","nombre","formControlName","nombre","placeholder","Ingrese nombre"],["htmlFor","apellido"],["pInputText","","id","apellido","formControlName","apellido","placeholder","Ingrese apellido"],[1,"flex","align-items-center","col-12","p-3","m-0"],["htmlFor","cambiarPassword",1,"pr-2"],["formControlName","cambiarPassword","onLabel","S\xcd","offLabel","NO",3,"onChange"],[1,"text-center","col-12","p-3","m-0"],["label","Guardar","type","submit","icon","pi pi-check",3,"disabled"],["label","Cancelar","icon","pi pi-times","styleClass","p-button-secondary"],[1,"error-message"],[4,"ngIf"]],template:function(t,r){if(1&t&&(e._UZ(0,"app-tool-bar"),e.TgZ(1,"h1"),e._uU(2,"Perfil"),e.qZA(),e._UZ(3,"hr"),e.TgZ(4,"div",0)(5,"div",1)(6,"div",2)(7,"app-upload-profile-img",3),e.NdJ("imageSelected",function(s){return r.onImageSelected(s)}),e.qZA()(),e.TgZ(8,"form",4),e.NdJ("ngSubmit",function(){return r.guardar()}),e.TgZ(9,"div",5)(10,"div",6)(11,"label",7),e._uU(12,"Nombre de usuario"),e.TgZ(13,"span",8),e._uU(14,"*"),e.qZA()(),e._UZ(15,"input",9),e.TgZ(16,"div",10),e.YNc(17,y,3,2,"div",11),e.qZA()(),e.TgZ(18,"div",6)(19,"label",12),e._uU(20,"Email"),e.qZA(),e._UZ(21,"input",13),e.TgZ(22,"div",10),e.YNc(23,M,2,1,"div",11),e.qZA()(),e.TgZ(24,"div",6)(25,"label",14),e._uU(26,"Nombre"),e.TgZ(27,"span",8),e._uU(28,"*"),e.qZA()(),e._UZ(29,"input",15),e.TgZ(30,"div",10),e.YNc(31,z,3,2,"div",11),e.qZA()(),e.TgZ(32,"div",6)(33,"label",16),e._uU(34,"Apellido"),e.qZA(),e._UZ(35,"input",17),e.qZA(),e.TgZ(36,"div",18)(37,"label",19),e._uU(38,"\xbfCambio de contrase\xf1a?"),e.qZA(),e._UZ(39,"p-confirmPopup"),e.TgZ(40,"p-toggleButton",20),e.NdJ("onChange",function(s){return r.confirm(s,"cambiarPassword")}),e.qZA()()(),e.TgZ(41,"div",21),e._UZ(42,"p-button",22)(43,"p-button",23),e.qZA()()()()),2&t){let l,s,u;e.xp6(7),e.Q6J("imageUrl",r.imageUrl),e.xp6(1),e.Q6J("formGroup",r.miFormulario),e.xp6(9),e.Q6J("ngIf",null==(l=r.miFormulario.get("usuario"))?null:l.touched),e.xp6(6),e.Q6J("ngIf",null==(s=r.miFormulario.get("email"))?null:s.touched),e.xp6(8),e.Q6J("ngIf",null==(u=r.miFormulario.get("nombre"))?null:u.touched),e.xp6(11),e.Akn(e.DdM(10,v)),e.Q6J("disabled",r.miFormulario.invalid),e.xp6(1),e.Akn(e.DdM(11,v))}},dependencies:[c.O5,n._Y,n.Fj,n.JJ,n.JL,n.sg,n.u,_.u,h.zx,F.P,x.o,T.CO,U.o,N],styles:["*[_ngcontent-%COMP%]{margin:15px}.card-content[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{margin:0}.card[_ngcontent-%COMP%]{border:1px solid var(--surface-border)!important;border-radius:12px!important;margin-top:15px;margin-bottom:15px}.card-content[_ngcontent-%COMP%]{border:1px solid var(--surface-border)!important;border-radius:12px!important;width:100%;max-width:800px;background-color:#e4e2e260;padding-top:3rem!important;padding-bottom:3rem!important;padding-left:0;padding-right:0}"]})}return i})()},{path:"**",redirectTo:"auth"}]}];let q=(()=>{class i{static#e=this.\u0275fac=function(t){return new(t||i)};static#i=this.\u0275mod=e.oAB({type:i});static#t=this.\u0275inj=e.cJS({imports:[d.Bz.forChild(B),d.Bz]})}return i})();var O=a(6867),Q=a(4466);let E=(()=>{class i{static#e=this.\u0275fac=function(t){return new(t||i)};static#i=this.\u0275mod=e.oAB({type:i});static#t=this.\u0275inj=e.cJS({imports:[c.ez,n.UX,q,O.g,Q.m,n.u5]})}return i})()}}]);