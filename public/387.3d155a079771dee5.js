"use strict";(self.webpackChunksistema=self.webpackChunksistema||[]).push([[387],{5387:(ae,_,a)=>{a.r(_),a.d(_,{UsuariosModule:()=>re});var h=a(6895),n=a(433),v=a(4154),m=a(4325),g=a(805),F=a(5226),Z=a.n(F),e=a(8256),b=a(5948),A=a(248),T=a(3608),f=a(5593),N=a(369),U=a(1740),q=a(2210),I=a(1167);function y(t,l){1&t&&(e.TgZ(0,"div"),e._uU(1," Nombre de usuario requerido. "),e.qZA())}function S(t,l){1&t&&(e.TgZ(0,"div"),e._uU(1," El nombre de usuario debe tener al menos 4 caracteres. "),e.qZA())}function P(t,l){if(1&t&&(e.TgZ(0,"div",22),e.YNc(1,y,2,0,"div",18),e.YNc(2,S,2,0,"div",18),e.qZA()),2&t){const o=e.oxw();let i,r;e.xp6(1),e.Q6J("ngIf",null==(i=o.miFormulario.get("usuario"))?null:i.hasError("required")),e.xp6(1),e.Q6J("ngIf",null==(r=o.miFormulario.get("usuario"))?null:r.hasError("minlength"))}}function J(t,l){1&t&&(e.TgZ(0,"div"),e._uU(1," El email no es v\xe1lido. "),e.qZA())}function w(t,l){if(1&t&&(e.TgZ(0,"div",22),e.YNc(1,J,2,0,"div",18),e.qZA()),2&t){const o=e.oxw();let i;e.xp6(1),e.Q6J("ngIf",null==(i=o.miFormulario.get("email"))?null:i.hasError("email"))}}function Y(t,l){1&t&&(e.TgZ(0,"div"),e._uU(1," Nombre requerido. "),e.qZA())}function E(t,l){1&t&&(e.TgZ(0,"div"),e._uU(1," El nombre debe tener al menos 4 caracteres. "),e.qZA())}function Q(t,l){if(1&t&&(e.TgZ(0,"div",22),e.YNc(1,Y,2,0,"div",18),e.YNc(2,E,2,0,"div",18),e.qZA()),2&t){const o=e.oxw();let i,r;e.xp6(1),e.Q6J("ngIf",null==(i=o.miFormulario.get("nombre"))?null:i.hasError("required")),e.xp6(1),e.Q6J("ngIf",null==(r=o.miFormulario.get("nombre"))?null:r.hasError("minlength"))}}function M(t,l){1&t&&(e.TgZ(0,"div"),e._uU(1," Perfil requerido. "),e.qZA())}function O(t,l){if(1&t&&(e.TgZ(0,"div",22),e.YNc(1,M,2,0,"div",18),e.qZA()),2&t){const o=e.oxw();let i;e.xp6(1),e.Q6J("ngIf",null==(i=o.miFormulario.get("idPerfil"))?null:i.hasError("required"))}}function B(t,l){1&t&&(e.TgZ(0,"div"),e._uU(1," Sucursal requerida. "),e.qZA())}function L(t,l){if(1&t&&(e.TgZ(0,"div",22),e.YNc(1,B,2,0,"div",18),e.qZA()),2&t){const o=e.oxw();let i;e.xp6(1),e.Q6J("ngIf",null==(i=o.miFormulario.get("idSucursal"))?null:i.hasError("required"))}}function G(t,l){if(1&t){const o=e.EpF();e.ynx(0),e.TgZ(1,"div",23)(2,"label",24),e._uU(3,"Estado"),e.qZA(),e._UZ(4,"p-confirmPopup"),e.TgZ(5,"p-toggleButton",25),e.NdJ("onChange",function(r){e.CHM(o);const s=e.oxw();return e.KtG(s.confirm(r,"estado"))}),e.qZA()(),e.TgZ(6,"div",23)(7,"label",26),e._uU(8,"\xbfCambiar contrase\xf1a?"),e.qZA(),e._UZ(9,"p-confirmPopup"),e.TgZ(10,"p-toggleButton",27),e.NdJ("onChange",function(r){e.CHM(o);const s=e.oxw();return e.KtG(s.confirm(r,"cambiarPassword"))}),e.qZA()(),e.BQk()}}const C=function(){return{margin:".5em",width:"9rem"}};let x=(()=>{class t{constructor(o,i,r,s,u,p){this.fb=o,this.ref=i,this.config=r,this.confirmationService=s,this.usuarioService=u,this.sucursalService=p,this.miFormulario=this.fb.group({id:new n.NI({value:"",disabled:!1}),usuario:new n.NI({value:"",disabled:!1},[n.kI.required,n.kI.minLength(4)]),nombre:new n.NI({value:"",disabled:!1},[n.kI.required,n.kI.minLength(4)]),apellido:new n.NI({value:"",disabled:!1}),email:new n.NI({value:"",disabled:!1},n.kI.email),estado:new n.NI({value:!0,disabled:!1}),cambiarPassword:new n.NI({value:!0,disabled:!1}),idPerfil:new n.NI({value:null,disabled:!1},n.kI.required),idSucursal:new n.NI({value:null,disabled:!1},n.kI.required)}),this.edito=!1,this.perfiles=[{id:1,nombre:"Administrador"},{id:2,nombre:"Empleado"}],this.sucursalService.traerSucursales().subscribe(d=>{this.sucursales=d.filter(c=>c.estado)})}ngOnInit(){const o=this.config.data;o&&(this.edito=!0,this.miFormulario.get("usuario")?.disable(),this.miFormulario.get("idPerfil")?.disable(),this.miFormulario.get("idEmpresa")?.disable(),this.usuarioService.traerUnUsuario(o).subscribe(i=>{this.miFormulario.patchValue(i)}))}confirm(o,i){this.confirmationService.confirm({target:o.originalEvent.target,message:"\xbfCancelar cambio?",icon:"pi pi-exclamation-triangle",defaultFocus:"none",accept:()=>{this.miFormulario.get(i)?.setValue(!o.checked)}})}guardar(){this.edito?(this.miFormulario.get("usuario")?.enable(),this.miFormulario.get("idPerfil")?.enable(),this.miFormulario.get("idEmpresa")?.enable(),this.usuarioService.modificarUsuario(this.miFormulario.value).subscribe(o=>{Z().fire(o.msg,"",o.icon),o.ok&&this.closeForm()})):(this.miFormulario.get("id")?.disable(),this.usuarioService.crearUsuario(this.miFormulario.value).subscribe(o=>{Z().fire(o.msg,"",o.icon),o.ok&&this.closeForm()}))}closeForm(){this.edito=!1,this.ref.close()}static#e=this.\u0275fac=function(i){return new(i||t)(e.Y36(n.qu),e.Y36(m.E7),e.Y36(m.S),e.Y36(g.YP),e.Y36(b.i),e.Y36(A.f))};static#o=this.\u0275cmp=e.Xpm({type:t,selectors:[["app-formulario-usuarios"]],features:[e._Bn([g.YP])],decls:48,vars:20,consts:[["autocomplete","off",1,"pt-2",3,"formGroup","ngSubmit"],[1,"grid"],[1,"col-12","lg:col-6","p-3","m-0"],["htmlFor","usuario"],["pTooltip","Requerido","tooltipPosition","top",1,"required"],["pInputText","","id","usuario","formControlName","usuario","placeholder","Ingrese usuario"],[1,"h-1rem"],["class","error-message",4,"ngIf"],["htmlFor","email"],["pInputText","","id","email","formControlName","email","placeholder","Ingrese email"],["htmlFor","nombre"],["pInputText","","id","nombre","formControlName","nombre","placeholder","Ingrese nombre"],["htmlFor","apellido"],["pInputText","","id","apellido","formControlName","apellido","placeholder","Ingrese apellido"],["htmlFor","perfil"],["formControlName","idPerfil","optionLabel","nombre","optionValue","id","filterBy","nombre","placeholder","Seleccione perfil","appendTo","body","emptyFilterMessage","Sin resultados","emptyMessage","Sin resultados",3,"options","filter","showClear"],["htmlFor","idSucursal"],["formControlName","idSucursal","optionLabel","nombre","optionValue","id","filterBy","nombre","placeholder","Seleccione sucursal","appendTo","body","emptyFilterMessage","Sin resultados","emptyMessage","Sin resultados",3,"options","filter","showClear"],[4,"ngIf"],[1,"text-center","col-12","p-3","m-0"],["label","Guardar","type","submit","icon","pi pi-check",3,"disabled"],["label","Cancelar","icon","pi pi-times","styleClass","p-button-secondary",3,"onClick"],[1,"error-message"],[1,"flex","flex-column","col-12","lg:col-6","p-3","m-0"],["htmlFor","estado"],["formControlName","estado","onLabel","ACTIVO","offLabel","INACTIVO",3,"onChange"],["htmlFor","cambiarPassword"],["formControlName","cambiarPassword","onLabel","S\xcd","offLabel","NO",3,"onChange"]],template:function(i,r){if(1&i&&(e.TgZ(0,"form",0),e.NdJ("ngSubmit",function(){return r.guardar()}),e.TgZ(1,"div",1)(2,"div",2)(3,"label",3),e._uU(4,"Nombre de usuario"),e.TgZ(5,"span",4),e._uU(6,"*"),e.qZA()(),e._UZ(7,"input",5),e.TgZ(8,"div",6),e.YNc(9,P,3,2,"div",7),e.qZA()(),e.TgZ(10,"div",2)(11,"label",8),e._uU(12,"Email"),e.qZA(),e._UZ(13,"input",9),e.TgZ(14,"div",6),e.YNc(15,w,2,1,"div",7),e.qZA()(),e.TgZ(16,"div",2)(17,"label",10),e._uU(18,"Nombre"),e.TgZ(19,"span",4),e._uU(20,"*"),e.qZA()(),e._UZ(21,"input",11),e.TgZ(22,"div",6),e.YNc(23,Q,3,2,"div",7),e.qZA()(),e.TgZ(24,"div",2)(25,"label",12),e._uU(26,"Apellido"),e.qZA(),e._UZ(27,"input",13),e.qZA(),e.TgZ(28,"div",2)(29,"label",14),e._uU(30,"Perfil del sistema"),e.TgZ(31,"span",4),e._uU(32,"*"),e.qZA()(),e._UZ(33,"p-dropdown",15),e.TgZ(34,"div",6),e.YNc(35,O,2,1,"div",7),e.qZA()(),e.TgZ(36,"div",2)(37,"label",16),e._uU(38,"Sucursal"),e.TgZ(39,"span",4),e._uU(40,"*"),e.qZA()(),e._UZ(41,"p-dropdown",17),e.TgZ(42,"div",6),e.YNc(43,L,2,1,"div",7),e.qZA()(),e.YNc(44,G,11,0,"ng-container",18),e.qZA(),e.TgZ(45,"div",19),e._UZ(46,"p-button",20),e.TgZ(47,"p-button",21),e.NdJ("onClick",function(){return r.closeForm()}),e.qZA()()()),2&i){let s,u,p,d,c;e.Q6J("formGroup",r.miFormulario),e.xp6(9),e.Q6J("ngIf",null==(s=r.miFormulario.get("usuario"))?null:s.touched),e.xp6(6),e.Q6J("ngIf",null==(u=r.miFormulario.get("email"))?null:u.touched),e.xp6(8),e.Q6J("ngIf",null==(p=r.miFormulario.get("nombre"))?null:p.touched),e.xp6(10),e.Q6J("options",r.perfiles)("filter",!0)("showClear",!0),e.xp6(2),e.Q6J("ngIf",null==(d=r.miFormulario.get("idPerfil"))?null:d.touched),e.xp6(6),e.Q6J("options",r.sucursales)("filter",!0)("showClear",!0),e.xp6(2),e.Q6J("ngIf",null==(c=r.miFormulario.get("idSucursal"))?null:c.touched),e.xp6(1),e.Q6J("ngIf",r.edito),e.xp6(2),e.Akn(e.DdM(18,C)),e.Q6J("disabled",r.miFormulario.invalid),e.xp6(1),e.Akn(e.DdM(19,C))}},dependencies:[h.O5,n._Y,n.Fj,n.JJ,n.JL,n.sg,n.u,T.u,f.zx,N.P,U.o,q.Lt,I.CO]})}return t})();var V=a(308),D=a(6679),R=a(8741),k=a(6526);function z(t,l){if(1&t){const o=e.EpF();e.TgZ(0,"div",7)(1,"span",8),e._UZ(2,"i",9),e.TgZ(3,"input",10),e.NdJ("input",function(r){e.CHM(o),e.oxw();const s=e.MAs(6);return e.KtG(s.filterGlobal(r.target.value,"contains"))}),e.qZA()(),e.TgZ(4,"span")(5,"p-button",11),e.NdJ("click",function(){e.CHM(o);const r=e.oxw();return e.KtG(r.show())}),e.qZA()()()}}function H(t,l){1&t&&(e.TgZ(0,"tr")(1,"th"),e._uU(2,"Usuario"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Nombre"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Apellido"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Email"),e.qZA(),e.TgZ(9,"th",12),e._uU(10,"Perfil"),e.qZA(),e.TgZ(11,"th",12),e._uU(12,"Estado"),e.qZA(),e._UZ(13,"th"),e.qZA())}function K(t,l){if(1&t){const o=e.EpF();e.TgZ(0,"tr")(1,"td")(2,"span",13),e._uU(3,"Usuario"),e.qZA(),e._uU(4),e.qZA(),e.TgZ(5,"td")(6,"span",13),e._uU(7,"Nombre"),e.qZA(),e._uU(8),e.qZA(),e.TgZ(9,"td")(10,"span",13),e._uU(11,"Apellido"),e.qZA(),e._uU(12),e.qZA(),e.TgZ(13,"td")(14,"span",13),e._uU(15,"Email"),e.qZA(),e._uU(16),e.qZA(),e.TgZ(17,"td",12)(18,"span",13),e._uU(19,"Perfil"),e.qZA(),e._UZ(20,"p-tag",14),e.qZA(),e.TgZ(21,"td",12)(22,"span",13),e._uU(23,"Estado"),e.qZA(),e._UZ(24,"p-tag",14),e.qZA(),e.TgZ(25,"td",12)(26,"button",15),e.NdJ("click",function(){const s=e.CHM(o).$implicit,u=e.oxw();return e.KtG(u.show(s.id))}),e.qZA()()()}if(2&t){const o=l.$implicit,i=e.oxw();e.xp6(4),e.Oqu(o.usuario),e.xp6(4),e.Oqu(o.nombre),e.xp6(4),e.Oqu(o.apellido?o.apellido:"-"),e.xp6(4),e.Oqu(o.email?o.email:"-"),e.xp6(4),e.Q6J("value",i.getNombrePerfil(o.idPerfil))("severity",i.getSeverity(o.perfil)),e.xp6(4),e.Q6J("value",o.estado?"ACTIVO":"INACTIVO")("severity",i.getSeverity(o.estado))}}function j(t,l){1&t&&(e.TgZ(0,"tr")(1,"td",16),e._uU(2,"No se encontraron registros"),e.qZA()()),2&t&&(e.xp6(1),e.uIk("colspan",7))}const X=function(){return{"min-width":"20rem"}},$=function(){return["nombre","apellido","email","estado"]},W=function(){return[10,25,50]},ee=[{path:"",children:[{path:"",component:(()=>{class t{constructor(o,i){this.usuarioService=o,this.dialogService=i,this.usuarios=[],this.perfiles=[{id:1,nombre:"Administrador"},{id:2,nombre:"Empleado"}]}ngOnInit(){this.traerUsuarios()}traerUsuarios(){this.subscription=this.usuarioService.traerUsuarios().subscribe(o=>{this.usuarios=o.sort((i,r)=>r.id-i.id)})}getSeverity(o){switch(o){case!0:return"success";case!1:return"danger";default:return""}}getNombrePerfil(o){return this.perfiles.filter(r=>r.id===o)[0].nombre}show(o){this.ref=this.dialogService.open(x,{header:o?"Editar usuario":"Nuevo usuario",width:"70%",contentStyle:{overflow:"auto"},maximizable:!0,styleClass:"customer-dialog-form",data:o}),this.ref.onClose.subscribe(()=>{this.traerUsuarios()})}ngOnDestroy(){this.ref&&this.ref.close(),this.subscription.unsubscribe()}static#e=this.\u0275fac=function(i){return new(i||t)(e.Y36(b.i),e.Y36(m.xA))};static#o=this.\u0275cmp=e.Xpm({type:t,selectors:[["app-tabla-usuarios"]],features:[e._Bn([m.xA])],decls:12,vars:10,consts:[[1,"card"],["dataKey","id","responsiveLayout","stack","currentPageReportTemplate","{first} al {last} de {totalRecords}",3,"value","tableStyle","paginator","rows","showCurrentPageReport","globalFilterFields","rowsPerPageOptions"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"flex","align-items-center","justify-content-between","my-0","py-0"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar...",3,"input"],["icon","pi pi-plus","styleClass","p-button-rounded p-button-heart p-button-outlined","pTooltip","Nuevo usuario","tooltipPosition","top",3,"click"],[1,"text-center"],[1,"p-column-title"],[1,"uppercase",3,"value","severity"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-help",3,"click"],[1,"text-center",2,"color","grey"]],template:function(i,r){1&i&&(e._UZ(0,"app-tool-bar"),e.TgZ(1,"h1"),e._uU(2,"Usuarios"),e.qZA(),e._UZ(3,"hr"),e.TgZ(4,"div",0)(5,"p-table",1,2),e.YNc(7,z,6,0,"ng-template",3),e.YNc(8,H,14,0,"ng-template",4),e.YNc(9,K,27,8,"ng-template",5),e.YNc(10,j,3,1,"ng-template",6),e.qZA()(),e._UZ(11,"app-footer")),2&i&&(e.xp6(5),e.Q6J("value",r.usuarios)("tableStyle",e.DdM(7,X))("paginator",r.usuarios.length>10)("rows",5)("showCurrentPageReport",!0)("globalFilterFields",e.DdM(8,$))("rowsPerPageOptions",e.DdM(9,W)))},dependencies:[T.u,g.jx,f.Hq,f.zx,V.iA,D.V,U.o,R.o,k.c],styles:["*[_ngcontent-%COMP%]{margin:15px}.card[_ngcontent-%COMP%]{border:1px solid var(--surface-border)!important;border-radius:12px!important}"]})}return t})()},{path:"form-usuarios",component:x},{path:"**",redirectTo:"auth"}]}];let oe=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#o=this.\u0275mod=e.oAB({type:t});static#t=this.\u0275inj=e.cJS({imports:[v.Bz.forChild(ee),v.Bz]})}return t})();var te=a(6867),ie=a(4466);let re=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#o=this.\u0275mod=e.oAB({type:t});static#t=this.\u0275inj=e.cJS({imports:[h.ez,n.UX,oe,te.g,ie.m]})}return t})()}}]);