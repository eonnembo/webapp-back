"use strict";(self.webpackChunksistema=self.webpackChunksistema||[]).push([[370],{7370:(de,v,l)=>{l.r(v),l.d(v,{ClientesModule:()=>pe});var Z=l(6895),C=l(4154),f=l(5849),a=l(433),e=l(8256),u=l(9646),m=l(4004),p=l(262),N=l(2340),q=l(529);let T=(()=>{class i{get cliente(){return{...this._cliente}}constructor(n){this.http=n,this.baseUrl=N.N.baseUrl}traerClientes(){return this.http.get(`${this.baseUrl}/cliente`).pipe((0,m.U)(t=>t),(0,p.K)(t=>(0,u.of)(!1)))}traerUnCliente(n){return this.http.get(`${this.baseUrl}/cliente/${n}`).pipe((0,m.U)(o=>o),(0,p.K)(o=>(0,u.of)(!1)))}crearCliente(n){return this.http.post(`${this.baseUrl}/cliente`,n).pipe((0,m.U)(o=>o),(0,p.K)(o=>(0,u.of)(o.error)))}modificarCliente(n){return this.http.put(`${this.baseUrl}/cliente/${n.id}`,n).pipe((0,m.U)(o=>o),(0,p.K)(o=>(0,u.of)(o.error)))}eliminarCliente(n){return this.http.delete(`${this.baseUrl}/cliente/${n}`).pipe((0,m.U)(o=>o),(0,p.K)(o=>(0,u.of)(o.error)))}static#e=this.\u0275fac=function(t){return new(t||i)(e.LFG(q.eN))};static#t=this.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var b=l(5593),_=l(1740),y=l(7248),E=l(8645);function w(i,r){1&i&&(e.TgZ(0,"div"),e._uU(1," Nombre requerido. "),e.qZA())}function J(i,r){if(1&i&&(e.TgZ(0,"div",21),e.YNc(1,w,2,0,"div",22),e.qZA()),2&i){const n=e.oxw();let t;e.xp6(1),e.Q6J("ngIf",null==(t=n.miFormulario.get("nombre"))?null:t.hasError("required"))}}function Y(i,r){1&i&&(e.TgZ(0,"div"),e._uU(1," Apellido requerido. "),e.qZA())}function S(i,r){if(1&i&&(e.TgZ(0,"div",21),e.YNc(1,Y,2,0,"div",22),e.qZA()),2&i){const n=e.oxw();let t;e.xp6(1),e.Q6J("ngIf",null==(t=n.miFormulario.get("apellido"))?null:t.hasError("required"))}}function D(i,r){1&i&&(e.TgZ(0,"div"),e._uU(1," DNI requerido. "),e.qZA())}function Q(i,r){if(1&i&&(e.TgZ(0,"div",21),e.YNc(1,D,2,0,"div",22),e.qZA()),2&i){const n=e.oxw();let t;e.xp6(1),e.Q6J("ngIf",null==(t=n.miFormulario.get("dni"))?null:t.hasError("required"))}}function O(i,r){1&i&&(e.TgZ(0,"div"),e._uU(1," Fecha de nacimiento requerida. "),e.qZA())}function $(i,r){if(1&i&&(e.TgZ(0,"div",21),e.YNc(1,O,2,0,"div",22),e.qZA()),2&i){const n=e.oxw();let t;e.xp6(1),e.Q6J("ngIf",null==(t=n.miFormulario.get("fechaNacimiento"))?null:t.hasError("required"))}}function M(i,r){1&i&&(e.TgZ(0,"div"),e._uU(1," El email no es v\xe1lido. "),e.qZA())}function P(i,r){if(1&i&&(e.TgZ(0,"div",21),e.YNc(1,M,2,0,"div",22),e.qZA()),2&i){const n=e.oxw();let t;e.xp6(1),e.Q6J("ngIf",null==(t=n.miFormulario.get("email"))?null:t.hasError("email"))}}function k(i,r){1&i&&(e.TgZ(0,"div"),e._uU(1," Tel\xe9fono requerido. "),e.qZA())}function K(i,r){if(1&i&&(e.TgZ(0,"div",21),e.YNc(1,k,2,0,"div",22),e.qZA()),2&i){const n=e.oxw();let t;e.xp6(1),e.Q6J("ngIf",null==(t=n.miFormulario.get("telefono"))?null:t.hasError("required"))}}const R=function(){return{"margin-left":".5em"}};let x=(()=>{class i{constructor(n,t,o,s){this.fb=n,this.clienteService=t,this.ref=o,this.config=s,this.miFormulario=this.fb.group({id:new a.NI({value:"",disabled:!1}),nombre:new a.NI({value:"",disabled:!1},[a.kI.required]),apellido:new a.NI({value:"",disabled:!1},[a.kI.required]),dni:new a.NI({value:null,disabled:!1},[a.kI.required]),fechaNacimiento:new a.NI({value:"",disabled:!1},[a.kI.required]),email:new a.NI({value:"",disabled:!1},[a.kI.required,a.kI.email]),telefono:new a.NI({value:"",disabled:!1},[a.kI.required]),estado:new a.NI({value:"PENDIENTE",disabled:!1}),idEmpresa:new a.NI({value:this.config.data.idEmpresa,disabled:!1})}),this.edito=!1}ngOnInit(){const n=this.config.data.id;n&&(this.edito=!0,this.miFormulario.get("dni")?.disable(),this.clienteService.traerUnCliente(n).subscribe(t=>{this.miFormulario.patchValue({...t,idEmpresa:this.config.data.idEmpresa})}))}guardar(){this.edito?(this.miFormulario.get("id")?.enable(),this.miFormulario.get("dni")?.enable()):this.miFormulario.get("id")?.disable(),this.ref.close({edito:this.edito,data:this.miFormulario.value}),this.edito=!1}closeForm(){this.edito=!1,this.ref.close()}static#e=this.\u0275fac=function(t){return new(t||i)(e.Y36(a.qu),e.Y36(T),e.Y36(f.E7),e.Y36(f.S))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-formulario-clientes"]],decls:41,vars:13,consts:[["autocomplete","off",1,"pt-2",3,"formGroup","ngSubmit"],[1,"grid"],[1,"col-12","lg:col-6","p-3","m-0"],["htmlFor","nombre"],["pInputText","","id","nombre","formControlName","nombre","placeholder","Ingrese nombre"],[1,"h-1rem"],["class","error-message",4,"ngIf"],["htmlFor","apellido"],["pInputText","","id","apellido","formControlName","apellido","placeholder","Ingrese apellido"],[1,"flex","flex-column","col-12","lg:col-6","p-3","m-0"],["htmlFor","dni"],["id","dni","formControlName","dni","placeholder","Ingrese DNI",3,"min","max"],["htmlFor","fechaNacimiento"],["formControlName","fechaNacimiento","dateFormat","dd/mm/yy","placeholder","Ingrese fecha","appendTo","body"],["htmlFor","email"],["pInputText","","id","email","formControlName","email","placeholder","Ingrese email"],["htmlFor","telefono"],["pInputText","","id","telefono","formControlName","telefono","placeholder","Ingrese tel\xe9fono"],[1,"text-center","col-12","p-3","m-0"],["label","Guardar","type","submit","icon","pi pi-check",3,"disabled"],["label","Cancelar","icon","pi pi-times","styleClass","p-button-secondary",3,"click"],[1,"error-message"],[4,"ngIf"]],template:function(t,o){if(1&t&&(e.TgZ(0,"form",0),e.NdJ("ngSubmit",function(){return o.guardar()}),e.TgZ(1,"div",1)(2,"div",2)(3,"label",3),e._uU(4,"Nombre"),e.qZA(),e._UZ(5,"input",4),e.TgZ(6,"div",5),e.YNc(7,J,2,1,"div",6),e.qZA()(),e.TgZ(8,"div",2)(9,"label",7),e._uU(10,"Apellido"),e.qZA(),e._UZ(11,"input",8),e.TgZ(12,"div",5),e.YNc(13,S,2,1,"div",6),e.qZA()(),e.TgZ(14,"div",9)(15,"label",10),e._uU(16,"DNI"),e.qZA(),e._UZ(17,"p-inputNumber",11),e.TgZ(18,"div",5),e.YNc(19,Q,2,1,"div",6),e.qZA()(),e.TgZ(20,"div",2)(21,"label",12),e._uU(22,"Fecha de nacimiento"),e.qZA(),e._UZ(23,"p-calendar",13),e.TgZ(24,"div",5),e.YNc(25,$,2,1,"div",6),e.qZA()(),e.TgZ(26,"div",2)(27,"label",14),e._uU(28,"Email"),e.qZA(),e._UZ(29,"input",15),e.TgZ(30,"div",5),e.YNc(31,P,2,1,"div",6),e.qZA()(),e.TgZ(32,"div",2)(33,"label",16),e._uU(34,"Tel\xe9fono"),e.qZA(),e._UZ(35,"input",17),e.TgZ(36,"div",5),e.YNc(37,K,2,1,"div",6),e.qZA()()(),e.TgZ(38,"div",18),e._UZ(39,"p-button",19),e.TgZ(40,"p-button",20),e.NdJ("click",function(){return o.closeForm()}),e.qZA()()()),2&t){let s,c,A,I,U,F;e.Q6J("formGroup",o.miFormulario),e.xp6(7),e.Q6J("ngIf",null==(s=o.miFormulario.get("nombre"))?null:s.touched),e.xp6(6),e.Q6J("ngIf",null==(c=o.miFormulario.get("apellido"))?null:c.touched),e.xp6(4),e.Q6J("min",1e7)("max",99999999),e.xp6(2),e.Q6J("ngIf",null==(A=o.miFormulario.get("dni"))?null:A.touched),e.xp6(6),e.Q6J("ngIf",null==(I=o.miFormulario.get("fechaNacimiento"))?null:I.touched),e.xp6(6),e.Q6J("ngIf",null==(U=o.miFormulario.get("email"))?null:U.touched),e.xp6(6),e.Q6J("ngIf",null==(F=o.miFormulario.get("telefono"))?null:F.touched),e.xp6(2),e.Q6J("disabled",o.miFormulario.invalid),e.xp6(1),e.Akn(e.DdM(12,R))}},dependencies:[Z.O5,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u,b.zx,_.o,y.Rn,E.f]})}return i})();var B=l(5226),g=l.n(B);class d extends Error{}d.prototype.name="InvalidTokenError";var h=l(805),H=l(3608),V=l(2137),L=l(1755),X=l(6679),W=l(8741),ee=l(6526);function te(i,r){if(1&i){const n=e.EpF();e.TgZ(0,"div",6)(1,"span",7),e._UZ(2,"i",8),e.TgZ(3,"input",9),e.NdJ("input",function(o){e.CHM(n),e.oxw();const s=e.MAs(6);return e.KtG(s.filterGlobal(o.target.value,"contains"))}),e.qZA()(),e.TgZ(4,"span")(5,"button",10),e.NdJ("click",function(){e.CHM(n);const o=e.oxw();return e.KtG(o.show())}),e.qZA()()()}}function ie(i,r){1&i&&(e.TgZ(0,"tr")(1,"th"),e._uU(2,"Nombre"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Apellido"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"DNI"),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Email"),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Tel\xe9fono"),e.qZA(),e.TgZ(11,"th",11),e._uU(12,"Estado"),e.qZA(),e._UZ(13,"th"),e.qZA())}function ne(i,r){if(1&i){const n=e.EpF();e.TgZ(0,"tr")(1,"td")(2,"span",12),e._uU(3,"Nombre"),e.qZA(),e._uU(4),e.qZA(),e.TgZ(5,"td")(6,"span",12),e._uU(7,"Apellido"),e.qZA(),e._uU(8),e.qZA(),e.TgZ(9,"td")(10,"span",12),e._uU(11,"DNI"),e.qZA(),e._uU(12),e.qZA(),e.TgZ(13,"td")(14,"span",12),e._uU(15,"Email"),e.qZA(),e._uU(16),e.qZA(),e.TgZ(17,"td")(18,"span",12),e._uU(19,"Tel\xe9fono"),e.qZA(),e._uU(20),e.qZA(),e.TgZ(21,"td",11)(22,"span",12),e._uU(23,"Estado"),e.qZA(),e._UZ(24,"p-tag",13),e.qZA(),e.TgZ(25,"td",11)(26,"button",14),e.NdJ("click",function(){const s=e.CHM(n).$implicit,c=e.oxw();return e.KtG(c.show(s.id))}),e.qZA(),e.TgZ(27,"button",15),e.NdJ("click",function(){const s=e.CHM(n).$implicit,c=e.oxw();return e.KtG(c.eliminar(s.id))}),e.qZA()()()}if(2&i){const n=r.$implicit,t=e.oxw();e.xp6(4),e.Oqu(n.nombre),e.xp6(4),e.Oqu(n.apellido),e.xp6(4),e.Oqu(n.dni),e.xp6(4),e.Oqu(n.email),e.xp6(4),e.Oqu(n.telefono),e.xp6(4),e.Q6J("value",n.estado)("severity",t.getSeverity(n.estado))}}const oe=function(){return{"min-width":"20rem"}},le=function(){return["nombre","apellido","email"]},re=function(){return[10,25,50]},ae=function(){return{width:"80vw",maxWidth:"60vh"}},se=[{path:"",children:[{path:"",component:(()=>{class i{constructor(n,t,o){this.clienteService=n,this.dialogService=t,this.confirmationService=o,this.clientes=[]}ngOnInit(){this.traerClientes()}traerClientes(){this.subscription=this.clienteService.traerClientes().subscribe(n=>{this.clientes=this.clientes=n.sort((t,o)=>o.id-t.id)})}show(n){const o=function z(i,r){if("string"!=typeof i)throw new d("Invalid token specified: must be a string");r||(r={});const n=!0===r.header?0:1,t=i.split(".")[n];if("string"!=typeof t)throw new d(`Invalid token specified: missing part #${n+1}`);let o;try{o=function j(i){let r=i.replace(/-/g,"+").replace(/_/g,"/");switch(r.length%4){case 0:break;case 2:r+="==";break;case 3:r+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return function G(i){return decodeURIComponent(atob(i).replace(/(.)/g,(r,n)=>{let t=n.charCodeAt(0).toString(16).toUpperCase();return t.length<2&&(t="0"+t),"%"+t}))}(r)}catch{return atob(r)}}(t)}catch(s){throw new d(`Invalid token specified: invalid base64 for part #${n+1} (${s.message})`)}try{return JSON.parse(o)}catch(s){throw new d(`Invalid token specified: invalid json for part #${n+1} (${s.message})`)}}(localStorage.getItem("token"));this.ref=this.dialogService.open(x,{header:n?"Editar cliente":"Nuevo cliente",width:"70%",contentStyle:{overflow:"auto"},baseZIndex:1e4,maximizable:!0,data:{id:n,idEmpresa:o.codigo}}),this.ref.onClose.subscribe(s=>{s&&(s.edito?this.clienteService.modificarCliente(s.data).subscribe(c=>{g().fire(c.msg,"",c.icon),this.traerClientes()}):this.clienteService.crearCliente(s.data).subscribe(c=>{g().fire(c.msg,"",c.icon),this.traerClientes()}))})}getSeverity(n){switch(n){case"ACTIVO":return"success";case"INACTIVO":return"danger";case"PENDIENTE":return"warning";default:return""}}eliminar(n){this.confirmationService.confirm({message:"\xbfDesea eliminar al cliente?",header:"Confirmaci\xf3n",icon:"pi pi-exclamation-triangle",accept:()=>{this.clienteService.eliminarCliente(n).subscribe(t=>{g().fire(t.msg,"",t.icon),this.traerClientes()})}})}ngOnDestroy(){this.ref&&this.ref.close(),this.subscription.unsubscribe()}static#e=this.\u0275fac=function(t){return new(t||i)(e.Y36(T),e.Y36(f.xA),e.Y36(h.YP))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-tabla-clientes"]],features:[e._Bn([f.xA,h.YP])],decls:12,vars:13,consts:[[1,"card"],["dataKey","id","responsiveLayout","stack","currentPageReportTemplate","{first} al {last} de {totalRecords}",3,"value","tableStyle","paginator","rows","showCurrentPageReport","globalFilterFields","rowsPerPageOptions"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],[1,"flex","align-items-center","justify-content-between","my-0","py-0"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar...",3,"input"],["pButton","","pRipple","","icon","pi pi-plus","pTooltip","Nuevo cliente","tooltipPosition","left",1,"p-button-success","mr-2",3,"click"],[1,"text-center"],[1,"p-column-title"],[1,"uppercase",3,"value","severity"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-help","mr-2",3,"click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-help",3,"click"]],template:function(t,o){1&t&&(e._UZ(0,"app-tool-bar"),e.TgZ(1,"h1"),e._uU(2,"Clientes"),e.qZA(),e._UZ(3,"hr"),e.TgZ(4,"div",0)(5,"p-table",1,2),e.YNc(7,te,6,0,"ng-template",3),e.YNc(8,ie,14,0,"ng-template",4),e.YNc(9,ne,28,7,"ng-template",5),e.qZA()(),e._UZ(10,"app-footer")(11,"p-confirmDialog")),2&t&&(e.xp6(5),e.Q6J("value",o.clientes)("tableStyle",e.DdM(9,oe))("paginator",o.clientes.length>10)("rows",5)("showCurrentPageReport",!0)("globalFilterFields",e.DdM(10,le))("rowsPerPageOptions",e.DdM(11,re)),e.xp6(6),e.Akn(e.DdM(12,ae)))},dependencies:[H.u,h.jx,b.Hq,V.Q,L.iA,X.V,_.o,W.o,ee.c],styles:["*[_ngcontent-%COMP%]{margin:15px}.card[_ngcontent-%COMP%]{border:1px solid var(--surface-border)!important;border-radius:12px!important}"]})}return i})()},{path:"form-clientes",component:x},{path:"**",redirectTo:"auth"}]}];let ce=(()=>{class i{static#e=this.\u0275fac=function(t){return new(t||i)};static#t=this.\u0275mod=e.oAB({type:i});static#i=this.\u0275inj=e.cJS({imports:[C.Bz.forChild(se),C.Bz]})}return i})();var ue=l(4466),me=l(6209);let pe=(()=>{class i{static#e=this.\u0275fac=function(t){return new(t||i)};static#t=this.\u0275mod=e.oAB({type:i});static#i=this.\u0275inj=e.cJS({imports:[Z.ez,a.UX,ce,me.g,ue.m]})}return i})()}}]);