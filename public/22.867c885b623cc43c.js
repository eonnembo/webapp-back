"use strict";(self.webpackChunksistema=self.webpackChunksistema||[]).push([[22],{8022:(oe,f,a)=>{a.r(f),a.d(f,{UsuariosModule:()=>te});var h=a(6895),b=a(4154),m=a(5849),n=a(433),g=a(805),e=a(8256),p=a(9646),c=a(4004),d=a(262),F=a(2340),x=a(529);let v=(()=>{class i{get usuario(){return{...this._usuario}}constructor(t){this.http=t,this.baseUrl=F.N.baseUrl}traerUsuarios(){return this.http.get(`${this.baseUrl}/usuario`).pipe((0,c.U)(o=>o),(0,d.K)(o=>(0,p.of)(!1)))}traerUnUsuario(t){return this.http.get(`${this.baseUrl}/usuario/${t}`).pipe((0,c.U)(r=>(this._usuario=r,r)),(0,d.K)(r=>(0,p.of)(!1)))}crearUsuario(t){return this.http.post(`${this.baseUrl}/usuario`,t).pipe((0,c.U)(r=>r),(0,d.K)(r=>(0,p.of)(r.error)))}modificarUsuario(t){return this.http.put(`${this.baseUrl}/usuario/${t.id}`,t).pipe((0,c.U)(r=>r),(0,d.K)(r=>(0,p.of)(r.error)))}static#e=this.\u0275fac=function(o){return new(o||i)(e.LFG(x.eN))};static#t=this.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var Z=a(5593),A=a(369),U=a(1740),N=a(4401),I=a(1167);function y(i,l){1&i&&(e.TgZ(0,"div"),e._uU(1," Nombre de usuario requerido. "),e.qZA())}function q(i,l){1&i&&(e.TgZ(0,"div"),e._uU(1," El nombre de usuario debe tener al menos 4 caracteres. "),e.qZA())}function E(i,l){if(1&i&&(e.TgZ(0,"div",21),e.YNc(1,y,2,0,"div",17),e.YNc(2,q,2,0,"div",17),e.qZA()),2&i){const t=e.oxw();let o,r;e.xp6(1),e.Q6J("ngIf",null==(o=t.miFormulario.get("usuario"))?null:o.hasError("required")),e.xp6(1),e.Q6J("ngIf",null==(r=t.miFormulario.get("usuario"))?null:r.hasError("minlength"))}}function S(i,l){1&i&&(e.TgZ(0,"div"),e._uU(1," El email no es v\xe1lido. "),e.qZA())}function J(i,l){if(1&i&&(e.TgZ(0,"div",21),e.YNc(1,S,2,0,"div",17),e.qZA()),2&i){const t=e.oxw();let o;e.xp6(1),e.Q6J("ngIf",null==(o=t.miFormulario.get("email"))?null:o.hasError("email"))}}function w(i,l){1&i&&(e.TgZ(0,"div"),e._uU(1," Nombre requerido. "),e.qZA())}function P(i,l){1&i&&(e.TgZ(0,"div"),e._uU(1," El nombre debe tener al menos 4 caracteres. "),e.qZA())}function Y(i,l){if(1&i&&(e.TgZ(0,"div",21),e.YNc(1,w,2,0,"div",17),e.YNc(2,P,2,0,"div",17),e.qZA()),2&i){const t=e.oxw();let o,r;e.xp6(1),e.Q6J("ngIf",null==(o=t.miFormulario.get("nombre"))?null:o.hasError("required")),e.xp6(1),e.Q6J("ngIf",null==(r=t.miFormulario.get("nombre"))?null:r.hasError("minlength"))}}function M(i,l){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",22)(2,"label",23),e._uU(3,"Estado"),e.qZA(),e._UZ(4,"p-confirmPopup"),e.TgZ(5,"p-toggleButton",24),e.NdJ("onChange",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.confirm(r,"estado"))}),e.qZA()(),e.TgZ(6,"div",22)(7,"label",25),e._uU(8,"\xbfCambio de contrase\xf1a?"),e.qZA(),e._UZ(9,"p-confirmPopup"),e.TgZ(10,"p-toggleButton",26),e.NdJ("onChange",function(r){e.CHM(t);const s=e.oxw();return e.KtG(s.confirm(r,"cambiarPassword"))}),e.qZA()(),e.BQk()}}const B=function(){return{"margin-left":".5em"}};let T=(()=>{class i{constructor(t,o,r,s,u){this.fb=t,this.usuarioService=o,this.ref=r,this.config=s,this.confirmationService=u,this.miFormulario=this.fb.group({id:new n.NI({value:"",disabled:!1}),usuario:new n.NI({value:"",disabled:!1},[n.kI.required,n.kI.minLength(4)]),nombre:new n.NI({value:"",disabled:!1},[n.kI.required,n.kI.minLength(4)]),apellido:new n.NI({value:"",disabled:!1}),email:new n.NI({value:"",disabled:!1},n.kI.email),estado:new n.NI({value:!0,disabled:!1}),cambiarPassword:new n.NI({value:!0,disabled:!1}),idPerfil:new n.NI({value:null,disabled:!1},n.kI.required),idEmpresa:new n.NI({value:null,disabled:!1},n.kI.required)}),this.edito=!1,this.perfiles=[{id:1,nombre:"Administrador"},{id:2,nombre:"Empleado"}],this.empresas=[{id:1,nombre:"RM Trainee"},{id:2,nombre:"Empresa B"}]}ngOnInit(){const t=this.config.data;t&&(this.edito=!0,this.miFormulario.get("usuario")?.disable(),this.miFormulario.get("idPerfil")?.disable(),this.miFormulario.get("idEmpresa")?.disable(),this.usuarioService.traerUnUsuario(t).subscribe(o=>{this.miFormulario.patchValue(o)}))}confirm(t,o){this.confirmationService.confirm({target:t.originalEvent.target,message:"\xbfCancelar cambio?",icon:"pi pi-exclamation-triangle",defaultFocus:"none",accept:()=>{this.miFormulario.get(o)?.setValue(!t.checked)}})}guardar(){this.edito?(this.miFormulario.get("usuario")?.enable(),this.miFormulario.get("idPerfil")?.enable(),this.miFormulario.get("idEmpresa")?.enable()):this.miFormulario.get("id")?.disable(),this.ref.close({edito:this.edito,data:this.miFormulario.value}),this.edito=!1}closeForm(){this.edito=!1,this.ref.close()}static#e=this.\u0275fac=function(o){return new(o||i)(e.Y36(n.qu),e.Y36(v),e.Y36(m.E7),e.Y36(m.S),e.Y36(g.YP))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-formulario-usuarios"]],features:[e._Bn([g.YP])],decls:36,vars:15,consts:[["autocomplete","off",1,"pt-2",3,"formGroup","ngSubmit"],[1,"grid"],[1,"col-12","lg:col-6","p-3","m-0"],["htmlFor","usuario"],["pInputText","","id","usuario","formControlName","usuario","placeholder","Ingrese usuario"],[1,"h-1rem"],["class","error-message",4,"ngIf"],["htmlFor","email"],["pInputText","","id","email","formControlName","email","placeholder","Ingrese email"],["htmlFor","nombre"],["pInputText","","id","nombre","formControlName","nombre","placeholder","Ingrese nombre"],["htmlFor","apellido"],["pInputText","","id","apellido","formControlName","apellido","placeholder","Ingrese apellido"],["htmlFor","perfil"],["formControlName","idPerfil","optionLabel","nombre","optionValue","id","filterBy","nombre","placeholder","Seleccione perfil","appendTo","body","emptyFilterMessage","Sin resultados","emptyMessage","Sin resultados",3,"options","filter","showClear"],["htmlFor","empresa"],["formControlName","idEmpresa","optionLabel","nombre","optionValue","id","filterBy","nombre","placeholder","Seleccione empresa","appendTo","body","emptyFilterMessage","Sin resultados","emptyMessage","Sin resultados",3,"options","filter","showClear"],[4,"ngIf"],[1,"text-center","col-12","p-3","m-0"],["label","Guardar","type","submit","icon","pi pi-check",3,"disabled"],["label","Cancelar","icon","pi pi-times","styleClass","p-button-secondary",3,"click"],[1,"error-message"],[1,"flex","flex-column","col-12","lg:col-6","p-3","m-0"],["htmlFor","estado"],["formControlName","estado","onLabel","ACTIVO","offLabel","INACTIVO",3,"onChange"],["htmlFor","cambiarPassword"],["formControlName","cambiarPassword","onLabel","S\xcd","offLabel","NO",3,"onChange"]],template:function(o,r){if(1&o&&(e.TgZ(0,"form",0),e.NdJ("ngSubmit",function(){return r.guardar()}),e.TgZ(1,"div",1)(2,"div",2)(3,"label",3),e._uU(4,"Nombre de usuario"),e.qZA(),e._UZ(5,"input",4),e.TgZ(6,"div",5),e.YNc(7,E,3,2,"div",6),e.qZA()(),e.TgZ(8,"div",2)(9,"label",7),e._uU(10,"Email"),e.qZA(),e._UZ(11,"input",8),e.TgZ(12,"div",5),e.YNc(13,J,2,1,"div",6),e.qZA()(),e.TgZ(14,"div",2)(15,"label",9),e._uU(16,"Nombre"),e.qZA(),e._UZ(17,"input",10),e.TgZ(18,"div",5),e.YNc(19,Y,3,2,"div",6),e.qZA()(),e.TgZ(20,"div",2)(21,"label",11),e._uU(22,"Apellido"),e.qZA(),e._UZ(23,"input",12),e.qZA(),e.TgZ(24,"div",2)(25,"label",13),e._uU(26,"Perfil del sistema"),e.qZA(),e._UZ(27,"p-dropdown",14),e.qZA(),e.TgZ(28,"div",2)(29,"label",15),e._uU(30,"Empresa"),e.qZA(),e._UZ(31,"p-dropdown",16),e.qZA(),e.YNc(32,M,11,0,"ng-container",17),e.qZA(),e.TgZ(33,"div",18),e._UZ(34,"p-button",19),e.TgZ(35,"p-button",20),e.NdJ("click",function(){return r.closeForm()}),e.qZA()()()),2&o){let s,u,C;e.Q6J("formGroup",r.miFormulario),e.xp6(7),e.Q6J("ngIf",null==(s=r.miFormulario.get("usuario"))?null:s.touched),e.xp6(6),e.Q6J("ngIf",null==(u=r.miFormulario.get("email"))?null:u.touched),e.xp6(6),e.Q6J("ngIf",null==(C=r.miFormulario.get("nombre"))?null:C.touched),e.xp6(8),e.Q6J("options",r.perfiles)("filter",!0)("showClear",!0),e.xp6(4),e.Q6J("options",r.empresas)("filter",!0)("showClear",!0),e.xp6(1),e.Q6J("ngIf",r.edito),e.xp6(2),e.Q6J("disabled",r.miFormulario.invalid),e.xp6(1),e.Akn(e.DdM(14,B))}},dependencies:[h.O5,n._Y,n.Fj,n.JJ,n.JL,n.sg,n.u,Z.zx,A.P,U.o,N.Lt,I.CO]})}return i})();var O=a(5226),_=a.n(O),Q=a(3608),L=a(1755),G=a(6679),K=a(8741),V=a(6526);function R(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"div",6)(1,"span",7),e._UZ(2,"i",8),e.TgZ(3,"input",9),e.NdJ("input",function(r){e.CHM(t),e.oxw();const s=e.MAs(6);return e.KtG(s.filterGlobal(r.target.value,"contains"))}),e.qZA()(),e.TgZ(4,"span")(5,"button",10),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.show())}),e.qZA()()()}}function $(i,l){1&i&&(e.TgZ(0,"tr")(1,"th"),e._uU(2,"Nombre"),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Apellido"),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Email"),e.qZA(),e.TgZ(7,"th",11),e._uU(8,"Estado"),e.qZA(),e._UZ(9,"th"),e.qZA())}function z(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"tr")(1,"td")(2,"span",12),e._uU(3,"Nombre"),e.qZA(),e._uU(4),e.qZA(),e.TgZ(5,"td")(6,"span",12),e._uU(7,"Apellido"),e.qZA(),e._uU(8),e.qZA(),e.TgZ(9,"td")(10,"span",12),e._uU(11,"Email"),e.qZA(),e._uU(12),e.qZA(),e.TgZ(13,"td",11)(14,"span",12),e._uU(15,"Estado"),e.qZA(),e._UZ(16,"p-tag",13),e.qZA(),e.TgZ(17,"td",11)(18,"button",14),e.NdJ("click",function(){const s=e.CHM(t).$implicit,u=e.oxw();return e.KtG(u.show(s.id))}),e.qZA()()()}if(2&i){const t=l.$implicit,o=e.oxw();e.xp6(4),e.Oqu(t.nombre),e.xp6(4),e.Oqu(t.apellido?t.apellido:"-"),e.xp6(4),e.Oqu(t.email?t.email:"-"),e.xp6(4),e.Q6J("value",t.estado?"ACTIVO":"INACTIVO")("severity",o.getSeverity(t.estado))}}const D=function(){return{"min-width":"20rem"}},H=function(){return["nombre","apellido","email","estado"]},j=function(){return[10,25,50]},X=[{path:"",children:[{path:"",component:(()=>{class i{constructor(t,o){this.usuarioServices=t,this.dialogService=o,this.usuarios=[]}ngOnInit(){this.traerUsuarios()}traerUsuarios(){this.subscription=this.usuarioServices.traerUsuarios().subscribe(t=>{this.usuarios=this.usuarios=t.sort((o,r)=>r.id-o.id)})}getSeverity(t){switch(t){case!0:return"success";case!1:return"danger";default:return""}}show(t){this.ref=this.dialogService.open(T,{header:t?"Editar usuario":"Nuevo usuario",width:"70%",contentStyle:{overflow:"auto"},baseZIndex:1e4,maximizable:!0,data:t}),this.ref.onClose.subscribe(o=>{o&&(o.edito?this.usuarioServices.modificarUsuario(o.data).subscribe(r=>{_().fire(r.msg,"",r.icon),this.traerUsuarios()}):this.usuarioServices.crearUsuario(o.data).subscribe(r=>{_().fire(r.msg,"",r.icon),this.traerUsuarios()}))})}ngOnDestroy(){this.ref&&this.ref.close(),this.subscription.unsubscribe()}static#e=this.\u0275fac=function(o){return new(o||i)(e.Y36(v),e.Y36(m.xA))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-tabla-usuarios"]],features:[e._Bn([m.xA])],decls:11,vars:10,consts:[[1,"card"],["dataKey","id","responsiveLayout","stack","currentPageReportTemplate","{first} al {last} de {totalRecords}",3,"value","tableStyle","paginator","rows","showCurrentPageReport","globalFilterFields","rowsPerPageOptions"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],[1,"flex","align-items-center","justify-content-between","my-0","py-0"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Buscar...",3,"input"],["pButton","","pRipple","","icon","pi pi-plus","pTooltip","Nuevo usuario","tooltipPosition","left",1,"p-button-success","mr-2",3,"click"],[1,"text-center"],[1,"p-column-title"],[1,"uppercase",3,"value","severity"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-help","mr-2",3,"click"]],template:function(o,r){1&o&&(e._UZ(0,"app-tool-bar"),e.TgZ(1,"h1"),e._uU(2,"Usuarios"),e.qZA(),e._UZ(3,"hr"),e.TgZ(4,"div",0)(5,"p-table",1,2),e.YNc(7,R,6,0,"ng-template",3),e.YNc(8,$,10,0,"ng-template",4),e.YNc(9,z,19,5,"ng-template",5),e.qZA()(),e._UZ(10,"app-footer")),2&o&&(e.xp6(5),e.Q6J("value",r.usuarios)("tableStyle",e.DdM(7,D))("paginator",r.usuarios.length>10)("rows",5)("showCurrentPageReport",!0)("globalFilterFields",e.DdM(8,H))("rowsPerPageOptions",e.DdM(9,j)))},dependencies:[Q.u,g.jx,Z.Hq,L.iA,G.V,U.o,K.o,V.c],styles:["*[_ngcontent-%COMP%]{margin:15px}.card[_ngcontent-%COMP%]{border:1px solid var(--surface-border)!important;border-radius:12px!important}"]})}return i})()},{path:"form-usuarios",component:T},{path:"**",redirectTo:"auth"}]}];let k=(()=>{class i{static#e=this.\u0275fac=function(o){return new(o||i)};static#t=this.\u0275mod=e.oAB({type:i});static#o=this.\u0275inj=e.cJS({imports:[b.Bz.forChild(X),b.Bz]})}return i})();var W=a(6209),ee=a(4466);let te=(()=>{class i{static#e=this.\u0275fac=function(o){return new(o||i)};static#t=this.\u0275mod=e.oAB({type:i});static#o=this.\u0275inj=e.cJS({imports:[h.ez,n.UX,k,W.g,ee.m]})}return i})()}}]);