"use strict";(self.webpackChunksistema=self.webpackChunksistema||[]).push([[45],{1045:(L,p,a)=>{a.r(p),a.d(p,{PerfilModule:()=>z});var c=a(6895),l=a(433),d=a(4154),g=a(805),v=a(5226),b=a.n(v),e=a(8256),Z=a(5948),F=a(248),_=a(3608),f=a(5593),I=a(369),T=a(1740),U=a(1167),C=a(8741),P=a(1481);const x=["fileInput"];let N=(()=>{class i{constructor(t){this.sanitizer=t,this.imageUrl="",this.imageSelected=new e.vpe}onSelectFile(t){const o=t.target.files[0];if(o){const r=new FileReader;r.onload=n=>{this.imageUrl=n.target.result,this.imageSelected.emit(n.target.result.split(",")[1])},r.readAsDataURL(o)}}triggerFileInput(){this.fileInput.nativeElement.click()}transform(t){return this.sanitizer.bypassSecurityTrustResourceUrl(t||"assets/images/img-user.png")}static#e=this.\u0275fac=function(o){return new(o||i)(e.Y36(P.H7))};static#i=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-upload-profile-img"]],viewQuery:function(o,r){if(1&o&&e.Gf(x,5),2&o){let n;e.iGM(n=e.CRH())&&(r.fileInput=n.first)}},inputs:{imageUrl:"imageUrl"},outputs:{imageSelected:"imageSelected"},decls:5,vars:1,consts:[[1,"image-container"],["pButton","","type","button","icon","pi pi-plus",1,"upload-button",3,"click"],["alt","Profile Image",1,"profile-img",3,"src"],["id","fileInput","type","file",1,"select-profile-picture",3,"change"],["fileInput",""]],template:function(o,r){1&o&&(e.TgZ(0,"div",0)(1,"button",1),e.NdJ("click",function(){return r.triggerFileInput()}),e.qZA(),e._UZ(2,"img",2),e.TgZ(3,"input",3,4),e.NdJ("change",function(s){return r.onSelectFile(s)}),e.qZA()()),2&o&&(e.xp6(2),e.Q6J("src",r.transform(r.imageUrl),e.LSH))},dependencies:[f.Hq],styles:[".image-container[_ngcontent-%COMP%]{position:relative;display:inline-block;text-align:center;width:100px;height:100px}img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;position:absolute;top:40%;left:40%;transform:translate(-50%,-50%);border-radius:50%}.profile-img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;border-radius:50%}.select-profile-picture[_ngcontent-%COMP%]{display:none}.upload-button[_ngcontent-%COMP%]{position:absolute;bottom:5px;right:5px;width:30px;height:30px;border-radius:50%;z-index:1000}"]})}return i})();function A(i,u){1&i&&(e.TgZ(0,"div"),e._uU(1," Nombre de usuario requerido. "),e.qZA())}function S(i,u){1&i&&(e.TgZ(0,"div"),e._uU(1," El nombre de usuario debe tener al menos 4 caracteres. "),e.qZA())}function y(i,u){if(1&i&&(e.TgZ(0,"div",24),e.YNc(1,A,2,0,"div",25),e.YNc(2,S,2,0,"div",25),e.qZA()),2&i){const t=e.oxw();let o,r;e.xp6(1),e.Q6J("ngIf",null==(o=t.miFormulario.get("usuario"))?null:o.hasError("required")),e.xp6(1),e.Q6J("ngIf",null==(r=t.miFormulario.get("usuario"))?null:r.hasError("minlength"))}}function J(i,u){1&i&&(e.TgZ(0,"div"),e._uU(1," El email no es v\xe1lido. "),e.qZA())}function w(i,u){if(1&i&&(e.TgZ(0,"div",24),e.YNc(1,J,2,0,"div",25),e.qZA()),2&i){const t=e.oxw();let o;e.xp6(1),e.Q6J("ngIf",null==(o=t.miFormulario.get("email"))?null:o.hasError("email"))}}function Y(i,u){1&i&&(e.TgZ(0,"div"),e._uU(1," Nombre requerido. "),e.qZA())}function E(i,u){1&i&&(e.TgZ(0,"div"),e._uU(1," El nombre debe tener al menos 4 caracteres. "),e.qZA())}function M(i,u){if(1&i&&(e.TgZ(0,"div",24),e.YNc(1,Y,2,0,"div",25),e.YNc(2,E,2,0,"div",25),e.qZA()),2&i){const t=e.oxw();let o,r;e.xp6(1),e.Q6J("ngIf",null==(o=t.miFormulario.get("nombre"))?null:o.hasError("required")),e.xp6(1),e.Q6J("ngIf",null==(r=t.miFormulario.get("nombre"))?null:r.hasError("minlength"))}}const h=function(){return{margin:".5em",width:"9rem"}},q=[{path:"",children:[{path:":idUsuario",component:(()=>{class i{constructor(t,o,r,n,s){this.fb=t,this.confirmationService=o,this.usuarioService=r,this.sucursalService=n,this.route=s,this.miFormulario=this.fb.group({id:new l.NI({value:"",disabled:!1}),img:new l.NI({value:"",disabled:!1}),usuario:new l.NI({value:"",disabled:!1},[l.kI.required,l.kI.minLength(4)]),nombre:new l.NI({value:"",disabled:!1},[l.kI.required,l.kI.minLength(4)]),apellido:new l.NI({value:"",disabled:!1}),email:new l.NI({value:"",disabled:!1},l.kI.email),estado:new l.NI({value:!0,disabled:!1}),cambiarPassword:new l.NI({value:!0,disabled:!1}),idPerfil:new l.NI({value:null,disabled:!1}),idSucursal:new l.NI({value:null,disabled:!1})}),this.perfiles=[{id:1,nombre:"Administrador"},{id:2,nombre:"Empleado"}],this.imageUrl="",this.isInitialLoad=!0,this.sucursalService.traerSucursales().subscribe(m=>{this.sucursales=m.filter(B=>B.estado)})}ngOnInit(){const t=this.route.snapshot.paramMap.get("idUsuario");t&&(this.miFormulario.get("usuario")?.disable(),this.miFormulario.get("idPerfil")?.disable(),this.miFormulario.get("idEmpresa")?.disable(),this.usuarioService.traerUnUsuario(Number(t)).subscribe(o=>{this.miFormulario.patchValue(o),o.img&&(this.imageUrl=`data:image/jpeg;base64,${o.img}`,this.isInitialLoad=!1)}))}onImageSelected(t){this.imageUrl=`data:image/jpeg;base64,${t}`,this.miFormulario.get("img")?.setValue(t)}confirm(t,o){this.confirmationService.confirm({target:t.originalEvent.target,message:"\xbfCancelar cambio?",icon:"pi pi-exclamation-triangle",defaultFocus:"none",accept:()=>{this.miFormulario.get(o)?.setValue(!t.checked)}})}guardar(){this.miFormulario.get("usuario")?.enable(),this.miFormulario.get("idPerfil")?.enable(),this.miFormulario.get("idEmpresa")?.enable(),this.usuarioService.modificarUsuario(this.miFormulario.value).subscribe(t=>{t.ok&&b().fire(t.msg,"",t.icon)})}static#e=this.\u0275fac=function(o){return new(o||i)(e.Y36(l.qu),e.Y36(g.YP),e.Y36(Z.i),e.Y36(F.f),e.Y36(d.gz))};static#i=this.\u0275cmp=e.Xpm({type:i,selectors:[["app-formulario-perfil"]],features:[e._Bn([g.YP])],decls:44,vars:12,consts:[[1,"flex","justify-content-center","card"],[1,"card-content"],[1,"flex","col","justify-content-center","mx-2"],[3,"imageUrl","imageSelected"],["autocomplete","off",1,"pt-2",3,"formGroup","ngSubmit"],[1,"grid"],[1,"col-12","lg:col-6","p-3","m-0"],["htmlFor","usuario"],["pTooltip","Requerido","tooltipPosition","top",1,"required"],["pInputText","","id","usuario","formControlName","usuario","placeholder","Ingrese usuario"],[1,"h-1rem"],["class","error-message",4,"ngIf"],["htmlFor","email"],["pInputText","","id","email","formControlName","email","placeholder","Ingrese email"],["htmlFor","nombre"],["pInputText","","id","nombre","formControlName","nombre","placeholder","Ingrese nombre"],["htmlFor","apellido"],["pInputText","","id","apellido","formControlName","apellido","placeholder","Ingrese apellido"],[1,"flex","align-items-center","col-12","p-3","m-0"],["htmlFor","cambiarPassword"],["formControlName","cambiarPassword","onLabel","S\xcd","offLabel","NO",3,"onChange"],[1,"text-center","col-12","p-3","m-0"],["label","Guardar","type","submit","icon","pi pi-check",3,"disabled"],["label","Cancelar","icon","pi pi-times","styleClass","p-button-secondary"],[1,"error-message"],[4,"ngIf"]],template:function(o,r){if(1&o&&(e._UZ(0,"app-tool-bar"),e.TgZ(1,"h1"),e._uU(2,"Perfil"),e.qZA(),e._UZ(3,"hr"),e.TgZ(4,"div",0)(5,"div",1)(6,"div",2)(7,"app-upload-profile-img",3),e.NdJ("imageSelected",function(s){return r.onImageSelected(s)}),e.qZA()(),e.TgZ(8,"form",4),e.NdJ("ngSubmit",function(){return r.guardar()}),e.TgZ(9,"div",5)(10,"div",6)(11,"label",7),e._uU(12,"Nombre de usuario"),e.TgZ(13,"span",8),e._uU(14,"*"),e.qZA()(),e._UZ(15,"input",9),e.TgZ(16,"div",10),e.YNc(17,y,3,2,"div",11),e.qZA()(),e.TgZ(18,"div",6)(19,"label",12),e._uU(20,"Email"),e.qZA(),e._UZ(21,"input",13),e.TgZ(22,"div",10),e.YNc(23,w,2,1,"div",11),e.qZA()(),e.TgZ(24,"div",6)(25,"label",14),e._uU(26,"Nombre"),e.TgZ(27,"span",8),e._uU(28,"*"),e.qZA()(),e._UZ(29,"input",15),e.TgZ(30,"div",10),e.YNc(31,M,3,2,"div",11),e.qZA()(),e.TgZ(32,"div",6)(33,"label",16),e._uU(34,"Apellido"),e.qZA(),e._UZ(35,"input",17),e.qZA(),e.TgZ(36,"div",18)(37,"label",19),e._uU(38,"\xbfCambio de contrase\xf1a?"),e.qZA(),e._UZ(39,"p-confirmPopup"),e.TgZ(40,"p-toggleButton",20),e.NdJ("onChange",function(s){return r.confirm(s,"cambiarPassword")}),e.qZA()()(),e.TgZ(41,"div",21),e._UZ(42,"p-button",22)(43,"p-button",23),e.qZA()()()()),2&o){let n,s,m;e.xp6(7),e.Q6J("imageUrl",r.imageUrl),e.xp6(1),e.Q6J("formGroup",r.miFormulario),e.xp6(9),e.Q6J("ngIf",null==(n=r.miFormulario.get("usuario"))?null:n.touched),e.xp6(6),e.Q6J("ngIf",null==(s=r.miFormulario.get("email"))?null:s.touched),e.xp6(8),e.Q6J("ngIf",null==(m=r.miFormulario.get("nombre"))?null:m.touched),e.xp6(11),e.Akn(e.DdM(10,h)),e.Q6J("disabled",r.miFormulario.invalid),e.xp6(1),e.Akn(e.DdM(11,h))}},dependencies:[c.O5,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,_.u,f.zx,I.P,T.o,U.CO,C.o,N],styles:["*[_ngcontent-%COMP%]{margin:15px}.card[_ngcontent-%COMP%]{border:1px solid var(--surface-border)!important;border-radius:12px!important}.card-content[_ngcontent-%COMP%]{border:1px solid var(--surface-border)!important;border-radius:12px!important;width:100%;max-width:800px;background-color:#e4e2e260}"]})}return i})()},{path:"**",redirectTo:"auth"}]}];let Q=(()=>{class i{static#e=this.\u0275fac=function(o){return new(o||i)};static#i=this.\u0275mod=e.oAB({type:i});static#t=this.\u0275inj=e.cJS({imports:[d.Bz.forChild(q),d.Bz]})}return i})();var O=a(6867),j=a(4466);let z=(()=>{class i{static#e=this.\u0275fac=function(o){return new(o||i)};static#i=this.\u0275mod=e.oAB({type:i});static#t=this.\u0275inj=e.cJS({imports:[c.ez,l.UX,Q,O.g,j.m,l.u5]})}return i})()}}]);