"use strict";(self.webpackChunksistema=self.webpackChunksistema||[]).push([[774],{774:(x,b,r)=>{r.r(b),r.d(b,{PerfilModule:()=>U});var u=r(6895),t=r(433),d=r(4154),C=r(805),v=r(5226),f=r.n(v),e=r(8256),s=r(5948),T=r(248),i=r(3608),a=r(5593),o=r(369),O=r(1740),S=r(1167),D=r(8741),y=r(2556);function N(n,E){1&n&&(e.TgZ(0,"div"),e._uU(1," Nombre de usuario requerido. "),e.qZA())}function B(n,E){1&n&&(e.TgZ(0,"div"),e._uU(1," El nombre de usuario debe tener al menos 4 caracteres. "),e.qZA())}function A(n,E){if(1&n&&(e.TgZ(0,"div",24),e.YNc(1,N,2,0,"div",25),e.YNc(2,B,2,0,"div",25),e.qZA()),2&n){const m=e.oxw();let p,_;e.xp6(1),e.Q6J("ngIf",null==(p=m.miFormulario.get("usuario"))?null:p.hasError("required")),e.xp6(1),e.Q6J("ngIf",null==(_=m.miFormulario.get("usuario"))?null:_.hasError("minlength"))}}function L(n,E){1&n&&(e.TgZ(0,"div"),e._uU(1," El email no es v\xe1lido. "),e.qZA())}function K(n,E){if(1&n&&(e.TgZ(0,"div",24),e.YNc(1,L,2,0,"div",25),e.qZA()),2&n){const m=e.oxw();let p;e.xp6(1),e.Q6J("ngIf",null==(p=m.miFormulario.get("email"))?null:p.hasError("email"))}}function Y(n,E){1&n&&(e.TgZ(0,"div"),e._uU(1," Nombre requerido. "),e.qZA())}function J(n,E){1&n&&(e.TgZ(0,"div"),e._uU(1," El nombre debe tener al menos 4 caracteres. "),e.qZA())}function $(n,E){if(1&n&&(e.TgZ(0,"div",24),e.YNc(1,Y,2,0,"div",25),e.YNc(2,J,2,0,"div",25),e.qZA()),2&n){const m=e.oxw();let p,_;e.xp6(1),e.Q6J("ngIf",null==(p=m.miFormulario.get("nombre"))?null:p.hasError("required")),e.xp6(1),e.Q6J("ngIf",null==(_=m.miFormulario.get("nombre"))?null:_.hasError("minlength"))}}const M=function(){return{margin:".5em",width:"9rem"}},Z=[{path:"",children:[{path:":idUsuario",component:(()=>{class n{constructor(m,p,_,I,P){this.fb=m,this.confirmationService=p,this.usuarioService=_,this.sucursalService=I,this.route=P,this.miFormulario=this.fb.group({id:new t.NI({value:"",disabled:!1}),img:new t.NI({value:"",disabled:!1}),usuario:new t.NI({value:"",disabled:!1},[t.kI.required,t.kI.minLength(4)]),nombre:new t.NI({value:"",disabled:!1},[t.kI.required,t.kI.minLength(4)]),apellido:new t.NI({value:"",disabled:!1}),email:new t.NI({value:"",disabled:!1},t.kI.email),estado:new t.NI({value:!0,disabled:!1}),cambiarPassword:new t.NI({value:!0,disabled:!1}),idPerfil:new t.NI({value:null,disabled:!1}),idSucursal:new t.NI({value:null,disabled:!1})}),this.perfiles=[{id:1,nombre:"Administrador"},{id:2,nombre:"Empleado"}],this.isInitialLoad=!0,this.sucursalService.traerSucursales().subscribe(F=>{this.sucursales=F.filter(j=>j.estado)})}ngOnInit(){const m=this.route.snapshot.paramMap.get("idUsuario");m&&(this.miFormulario.get("usuario")?.disable(),this.usuarioService.traerUnUsuario(Number(m)).subscribe(p=>{this.miFormulario.patchValue(p),p.img?(this.imageUrl=`data:image/jpeg;base64,${p.img}`,this.isInitialLoad=!1):this.imageUrl=null}))}onImageSelected(m){this.imageUrl=`data:image/jpeg;base64,${m}`,this.miFormulario.get("img")?.setValue(m)}onImageDeleted(){this.imageUrl=null,this.miFormulario.get("img")?.setValue(null)}confirm(m,p){this.confirmationService.confirm({target:m.originalEvent.target,message:"\xbfCancelar cambio?",icon:"pi pi-exclamation-triangle",defaultFocus:"none",accept:()=>{this.miFormulario.get(p)?.setValue(!m.checked)}})}guardar(){this.miFormulario.get("usuario")?.enable(),this.usuarioService.modificarUsuario(this.miFormulario.value).subscribe(m=>{f().fire(m.msg,"",m.icon),m.ok||this.miFormulario.get("usuario")?.disable()})}static#e=this.\u0275fac=function(p){return new(p||n)(e.Y36(t.qu),e.Y36(C.YP),e.Y36(s.i),e.Y36(T.f),e.Y36(d.gz))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-formulario-perfil"]],features:[e._Bn([C.YP])],decls:44,vars:12,consts:[[1,"flex","justify-content-center","card"],[1,"card-content"],[1,"flex","col","justify-content-center"],[3,"imageUrl","imageSelected","imageDeleted"],["autocomplete","off",1,"pt-2",3,"formGroup","ngSubmit"],[1,"grid"],[1,"col-12","lg:col-6","p-3","m-0"],["htmlFor","usuario"],["pTooltip","Requerido","tooltipPosition","top",1,"required"],["pInputText","","id","usuario","formControlName","usuario","placeholder","Ingrese usuario"],[1,"h-1rem"],["class","error-message",4,"ngIf"],["htmlFor","email"],["pInputText","","id","email","formControlName","email","placeholder","Ingrese email"],["htmlFor","nombre"],["pInputText","","id","nombre","formControlName","nombre","placeholder","Ingrese nombre"],["htmlFor","apellido"],["pInputText","","id","apellido","formControlName","apellido","placeholder","Ingrese apellido"],[1,"flex","align-items-center","col-12","p-3","m-0"],["htmlFor","cambiarPassword",1,"pr-2"],["formControlName","cambiarPassword","onLabel","S\xcd","offLabel","NO",3,"onChange"],[1,"text-center","col-12","p-3","m-0"],["label","Guardar","type","submit","icon","pi pi-check",3,"disabled"],["label","Cancelar","icon","pi pi-times","styleClass","p-button-secondary"],[1,"error-message"],[4,"ngIf"]],template:function(p,_){if(1&p&&(e._UZ(0,"app-tool-bar"),e.TgZ(1,"h1"),e._uU(2,"Perfil"),e.qZA(),e._UZ(3,"hr"),e.TgZ(4,"div",0)(5,"div",1)(6,"div",2)(7,"app-upload-profile-img",3),e.NdJ("imageSelected",function(P){return _.onImageSelected(P)})("imageDeleted",function(){return _.onImageDeleted()}),e.qZA()(),e.TgZ(8,"form",4),e.NdJ("ngSubmit",function(){return _.guardar()}),e.TgZ(9,"div",5)(10,"div",6)(11,"label",7),e._uU(12,"Nombre de usuario"),e.TgZ(13,"span",8),e._uU(14,"*"),e.qZA()(),e._UZ(15,"input",9),e.TgZ(16,"div",10),e.YNc(17,A,3,2,"div",11),e.qZA()(),e.TgZ(18,"div",6)(19,"label",12),e._uU(20,"Email"),e.qZA(),e._UZ(21,"input",13),e.TgZ(22,"div",10),e.YNc(23,K,2,1,"div",11),e.qZA()(),e.TgZ(24,"div",6)(25,"label",14),e._uU(26,"Nombre"),e.TgZ(27,"span",8),e._uU(28,"*"),e.qZA()(),e._UZ(29,"input",15),e.TgZ(30,"div",10),e.YNc(31,$,3,2,"div",11),e.qZA()(),e.TgZ(32,"div",6)(33,"label",16),e._uU(34,"Apellido"),e.qZA(),e._UZ(35,"input",17),e.qZA(),e.TgZ(36,"div",18)(37,"label",19),e._uU(38,"\xbfCambio de contrase\xf1a?"),e.qZA(),e._UZ(39,"p-confirmPopup"),e.TgZ(40,"p-toggleButton",20),e.NdJ("onChange",function(P){return _.confirm(P,"cambiarPassword")}),e.qZA()()(),e.TgZ(41,"div",21),e._UZ(42,"p-button",22)(43,"p-button",23),e.qZA()()()()),2&p){let I,P,F;e.xp6(7),e.Q6J("imageUrl",_.imageUrl),e.xp6(1),e.Q6J("formGroup",_.miFormulario),e.xp6(9),e.Q6J("ngIf",null==(I=_.miFormulario.get("usuario"))?null:I.touched),e.xp6(6),e.Q6J("ngIf",null==(P=_.miFormulario.get("email"))?null:P.touched),e.xp6(8),e.Q6J("ngIf",null==(F=_.miFormulario.get("nombre"))?null:F.touched),e.xp6(11),e.Akn(e.DdM(10,M)),e.Q6J("disabled",_.miFormulario.invalid),e.xp6(1),e.Akn(e.DdM(11,M))}},dependencies:[u.O5,t._Y,t.Fj,t.JJ,t.JL,t.sg,t.u,i.u,a.zx,o.P,O.o,S.CO,D.o,y.c],styles:["*[_ngcontent-%COMP%]{margin:15px}.card-content[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{margin:0}.card[_ngcontent-%COMP%]{border:1px solid var(--surface-border)!important;border-radius:12px!important;margin-top:15px;margin-bottom:15px}.card-content[_ngcontent-%COMP%]{border:1px solid var(--surface-border)!important;border-radius:12px!important;width:100%;max-width:800px;background-color:#e4e2e260;padding-top:50px!important;padding-bottom:20px!important;padding-left:15px;padding-right:15px}"]})}return n})()},{path:"**",redirectTo:"auth"}]}];let g=(()=>{class n{static#e=this.\u0275fac=function(p){return new(p||n)};static#t=this.\u0275mod=e.oAB({type:n});static#r=this.\u0275inj=e.cJS({imports:[d.Bz.forChild(Z),d.Bz]})}return n})();var c=r(6867),h=r(4466);let U=(()=>{class n{static#e=this.\u0275fac=function(p){return new(p||n)};static#t=this.\u0275mod=e.oAB({type:n});static#r=this.\u0275inj=e.cJS({imports:[u.ez,t.UX,g,c.g,h.m,t.u5]})}return n})()},8741:(x,b,r)=>{r.d(b,{o:()=>M});var u=r(5656),t=r(8256),d=r(629),C=r(248),v=r(7117),f=r(6895),e=r(1383),s=r(4154),T=r(805),i=r(3214),a=r(3930);const o=function(){return{width:"100%",height:"100%"}};function O(l,Z){1&l&&(t.TgZ(0,"p-scrollPanel")(1,"div",3)(2,"h3",4),t._uU(3," Dashboard "),t.qZA()(),t.TgZ(4,"div",5)(5,"h3",4),t._uU(6," Clientes "),t.qZA()(),t.TgZ(7,"div",6)(8,"h3",4),t._uU(9," Servicios "),t.qZA()()()),2&l&&t.Akn(t.DdM(2,o))}let S=(()=>{class l{constructor(){this.sidebarVisible=!1}ngOnInit(){}static#e=this.\u0275fac=function(c){return new(c||l)};static#t=this.\u0275cmp=t.Xpm({type:l,selectors:[["app-menu"]],decls:3,vars:1,consts:[[1,"p-0","m-0",3,"visible","visibleChange"],["pTemplate","content"],[1,"pi","pi-bars",2,"font-size","1.5rem","color","white","cursor","pointer",3,"click"],["routerLink","/dashboard",1,"line-menu","cursor-pointer"],[1,"uppercase"],["routerLink","/clientes",1,"line-menu","cursor-pointer"],["routerLink","/servicios",1,"line-menu","cursor-pointer"]],template:function(c,h){1&c&&(t.TgZ(0,"p-sidebar",0),t.NdJ("visibleChange",function(n){return h.sidebarVisible=n}),t.YNc(1,O,10,3,"ng-template",1),t.qZA(),t.TgZ(2,"i",2),t.NdJ("click",function(){return h.sidebarVisible=!0}),t.qZA()),2&c&&t.Q6J("visible",h.sidebarVisible)},dependencies:[s.rH,T.jx,i.Y,a.P],styles:[".line-menu[_ngcontent-%COMP%]{padding-top:15px;padding-bottom:15px;padding-left:15px;transition:background-color .3s,color .3s}.line-menu[_ngcontent-%COMP%]:hover{background:rgb(240,166,250);color:#fff}"]})}return l})();var D=r(5948),y=r(8271),N=r(9512),B=r(2137);const A=function(){return{cursor:"pointer"}};function L(l,Z){if(1&l){const g=t.EpF();t.TgZ(0,"p-avatar",6),t.NdJ("click",function(h){t.CHM(g),t.oxw();const U=t.MAs(5);return t.KtG(U.toggle(h))}),t.qZA()}if(2&l){const g=t.oxw();t.Q6J("image",g.userImage)("ngStyle",t.DdM(2,A))}}function K(l,Z){if(1&l){const g=t.EpF();t.TgZ(0,"p-avatar",7),t.NdJ("click",function(h){t.CHM(g),t.oxw();const U=t.MAs(5);return t.KtG(U.toggle(h))}),t.qZA()}2&l&&t.Q6J("ngStyle",t.DdM(1,A))}const Y=function(){return{width:"80vw",maxWidth:"60vh"}};let J=(()=>{class l{constructor(g,c,h,U){this.router=g,this.authService=c,this.confirmationService=h,this.usuarioService=U,this.menuVisible=!1,this.userImage=null,this.perfil=this.authService.logueo.idPerfil}get usuario(){return this.authService.logueo.usuario}ngOnInit(){this.usuarioService.traerUnUsuario(Number(this.authService.logueo.id)).subscribe(n=>{this.userImage=n.img?`data:image/jpeg;base64,${n.img}`:null});const g={label:`Perfil ${this.usuario}`,icon:"pi pi-fw pi-user",command:()=>this.router.navigateByUrl(`/perfil/${this.authService.logueo.id}`)},U={label:"Cerrar sesi\xf3n",icon:"pi pi-fw pi-power-off",command:()=>this.confirm()};this.items=1===this.perfil?[g,{label:"Usuarios",icon:"pi pi-fw pi-users",command:()=>this.router.navigateByUrl("/usuarios")},{label:"Configuraci\xf3n",icon:"pi pi-fw pi-cog",command:()=>this.router.navigateByUrl("/configuracion")},U]:[g,U]}confirm(){this.confirmationService.confirm({message:"\xbfDesea cerrar sesi\xf3n?",header:"Confirmaci\xf3n",icon:"pi pi-exclamation-triangle",accept:()=>{this.logout()}})}logout(){this.router.navigateByUrl("/auth"),this.authService.logout()}static#e=this.\u0275fac=function(c){return new(c||l)(t.Y36(s.F0),t.Y36(d.e),t.Y36(T.YP),t.Y36(D.i))};static#t=this.\u0275cmp=t.Xpm({type:l,selectors:[["app-avatar-usuario"]],features:[t._Bn([T.YP])],decls:7,vars:7,consts:[[1,"user-profile"],["styleClass","mr-3 avatar-with-shadow profile-avatar","size","large","shape","circle",3,"image","ngStyle","click",4,"ngIf","ngIfElse"],["defaultAvatar",""],[3,"model","popup"],["menu",""],[1,"confirmation"],["styleClass","mr-3 avatar-with-shadow profile-avatar","size","large","shape","circle",3,"image","ngStyle","click"],["icon","pi pi-user","styleClass","mr-3 avatar-with-shadow profile-avatar","size","large","shape","circle",3,"ngStyle","click"]],template:function(c,h){if(1&c&&(t.TgZ(0,"div",0),t.YNc(1,L,1,3,"p-avatar",1),t.YNc(2,K,1,2,"ng-template",null,2,t.W1O),t._UZ(4,"p-tieredMenu",3,4)(6,"p-confirmDialog",5),t.qZA()),2&c){const U=t.MAs(3);t.xp6(1),t.Q6J("ngIf",h.userImage)("ngIfElse",U),t.xp6(3),t.Q6J("model",h.items)("popup",!0),t.xp6(2),t.Akn(t.DdM(6,Y))}},dependencies:[f.O5,f.PC,y.q,N.yp,B.Q],styles:[".user-profile[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.profile-avatar[_ngcontent-%COMP%]{box-shadow:0 4px 8px #fff1f1a8!important;border:2px solid #ddd!important;transition:transform .2s ease!important}.greeting[_ngcontent-%COMP%]{font-size:1.2rem!important;font-weight:700!important;margin-right:1rem!important;text-shadow:1px 1px 2px rgba(161,157,163,.699)!important}"]})}return l})();function $(l,Z){if(1&l&&t._UZ(0,"img",4),2&l){const g=t.oxw();t.Q6J("src",g.logoBase64,t.LSH)}}let M=(()=>{class l{constructor(g,c,h){this.authService=g,this.sucursalService=c,this.empresaService=h,this.logoBase64=""}ngOnInit(){const g=localStorage.getItem("token"),c=(0,u.o)(g);this.idSucursal=c.codSuc,this.sucursalService.traerUnaSucursal(this.idSucursal).subscribe(h=>{this.idEmpresa=h.idEmpresa,this.empresaService.traerUnaEmpresa(this.idEmpresa).subscribe(U=>{U.img&&(this.logoBase64=`data:image/jpeg;base64,${U.img}`)})}),this.items=[{label:"Update",icon:"pi pi-refresh",command:()=>{}},{label:"Delete",icon:"pi pi-times",command:()=>{}},{label:"Angular.io",icon:"pi pi-info",url:"http://angular.io"},{separator:!0},{label:"Setup",icon:"pi pi-cog",routerLink:["/setup"]}]}static#e=this.\u0275fac=function(c){return new(c||l)(t.Y36(d.e),t.Y36(C.f),t.Y36(v.P))};static#t=this.\u0275cmp=t.Xpm({type:l,selectors:[["app-tool-bar"]],decls:7,vars:1,consts:[[1,"p-toolbar-group-start"],[1,"p-toolbar-group-center"],["alt","Logo","class","logo",3,"src",4,"ngIf"],[1,"p-toolbar-group-end"],["alt","Logo",1,"logo",3,"src"]],template:function(c,h){1&c&&(t.TgZ(0,"p-toolbar")(1,"div",0),t._UZ(2,"app-menu"),t.qZA(),t.TgZ(3,"div",1),t.YNc(4,$,1,1,"img",2),t.qZA(),t.TgZ(5,"div",3),t._UZ(6,"app-avatar-usuario"),t.qZA()()),2&c&&(t.xp6(4),t.Q6J("ngIf",h.logoBase64))},dependencies:[f.O5,e.o,S,J],styles:[".logo[_ngcontent-%COMP%]{width:150px;height:60px;object-fit:contain}"]})}return l})()},7117:(x,b,r)=>{r.d(b,{P:()=>e});var u=r(9646),t=r(4004),d=r(262),C=r(2340),v=r(8256),f=r(529);let e=(()=>{class s{get empresa(){return{...this._empresa}}constructor(i){this.http=i,this.baseUrl=C.N.baseUrl}traerEmpresas(){return this.http.get(`${this.baseUrl}/empresa`).pipe((0,t.U)(a=>a),(0,d.K)(a=>(0,u.of)(!1)))}traerUnaEmpresa(i){return this.http.get(`${this.baseUrl}/empresa/${i}`).pipe((0,t.U)(o=>(this._empresa=o,o)),(0,d.K)(o=>(0,u.of)(!1)))}crearEmpresa(i){return this.http.post(`${this.baseUrl}/empresa`,i).pipe((0,t.U)(o=>o),(0,d.K)(o=>(0,u.of)(o.error)))}modificarEmpresa(i){return this.http.put(`${this.baseUrl}/empresa/${i.id}`,i).pipe((0,t.U)(o=>o),(0,d.K)(o=>(0,u.of)(o.error)))}static#e=this.\u0275fac=function(a){return new(a||s)(v.LFG(f.eN))};static#t=this.\u0275prov=v.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})()},248:(x,b,r)=>{r.d(b,{f:()=>e});var u=r(9646),t=r(4004),d=r(262),C=r(2340),v=r(8256),f=r(529);let e=(()=>{class s{constructor(i){this.http=i,this.baseUrl=C.N.baseUrl}traerSucursales(){return this.http.get(`${this.baseUrl}/sucursal`).pipe((0,t.U)(a=>a),(0,d.K)(a=>(0,u.of)(!1)))}traerUnaSucursal(i){return this.http.get(`${this.baseUrl}/sucursal/${i}`).pipe((0,t.U)(o=>o),(0,d.K)(o=>(0,u.of)(!1)))}crearSucursal(i){return this.http.post(`${this.baseUrl}/sucursal`,i).pipe((0,t.U)(o=>o),(0,d.K)(o=>(0,u.of)(o.error)))}modificarSucursal(i){return this.http.put(`${this.baseUrl}/sucursal/${i.id}`,i).pipe((0,t.U)(o=>o),(0,d.K)(o=>(0,u.of)(o.error)))}eliminarSucursal(i){return this.http.delete(`${this.baseUrl}/sucursal/${i}`).pipe((0,t.U)(o=>o),(0,d.K)(o=>(0,u.of)(o.error)))}static#e=this.\u0275fac=function(a){return new(a||s)(v.LFG(f.eN))};static#t=this.\u0275prov=v.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})()},5948:(x,b,r)=>{r.d(b,{i:()=>e});var u=r(9646),t=r(4004),d=r(262),C=r(2340),v=r(8256),f=r(529);let e=(()=>{class s{get usuario(){return{...this._usuario}}constructor(i){this.http=i,this.baseUrl=C.N.baseUrl}traerUsuarios(){return this.http.get(`${this.baseUrl}/usuario`).pipe((0,t.U)(a=>a),(0,d.K)(a=>(0,u.of)(!1)))}traerUnUsuario(i){return this.http.get(`${this.baseUrl}/usuario/${i}`).pipe((0,t.U)(o=>(this._usuario=o,o)),(0,d.K)(o=>(0,u.of)(!1)))}crearUsuario(i){return this.http.post(`${this.baseUrl}/usuario`,i).pipe((0,t.U)(o=>o),(0,d.K)(o=>(0,u.of)(o.error)))}modificarUsuario(i){return this.http.put(`${this.baseUrl}/usuario/${i.id}`,i).pipe((0,t.U)(o=>o),(0,d.K)(o=>(0,u.of)(o.error)))}static#e=this.\u0275fac=function(a){return new(a||s)(v.LFG(f.eN))};static#t=this.\u0275prov=v.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})()},5656:(x,b,r)=>{r.d(b,{o:()=>C});class u extends Error{}function C(v,f){if("string"!=typeof v)throw new u("Invalid token specified: must be a string");f||(f={});const e=!0===f.header?0:1,s=v.split(".")[e];if("string"!=typeof s)throw new u(`Invalid token specified: missing part #${e+1}`);let T;try{T=function d(v){let f=v.replace(/-/g,"+").replace(/_/g,"/");switch(f.length%4){case 0:break;case 2:f+="==";break;case 3:f+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return function t(v){return decodeURIComponent(atob(v).replace(/(.)/g,(f,e)=>{let s=e.charCodeAt(0).toString(16).toUpperCase();return s.length<2&&(s="0"+s),"%"+s}))}(f)}catch{return atob(f)}}(s)}catch(i){throw new u(`Invalid token specified: invalid base64 for part #${e+1} (${i.message})`)}try{return JSON.parse(T)}catch(i){throw new u(`Invalid token specified: invalid json for part #${e+1} (${i.message})`)}}u.prototype.name="InvalidTokenError"}}]);